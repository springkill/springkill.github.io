<!DOCTYPE html><html lang="en" class="bg-[var(--page-bg)] transition text-[14px] md:text-[16px]" data-overlayscrollbars-initialize data-astro-cid-sckkx6r4 style="--bannerOffset: 15vh;--banner-height-home: 65vh;--banner-height: 35vh;--configHue: 35;--page-width: 75rem;"> <head><title>Remediation Recommendations (Summary) - SpringKill_春纱</title><meta charset="UTF-8"><meta name="description" content="Remediation Recommendations (Summary) - SpringKill_春纱"><meta name="author" content="SpringKill"><meta property="og:site_name" content="SpringKill_春纱"><meta property="og:url" content="https://springkill.github.io/en/posts/%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%E6%B1%87%E6%80%BB/"><meta property="og:title" content="Remediation Recommendations (Summary) - SpringKill_春纱"><meta property="og:description" content="Remediation Recommendations (Summary) - SpringKill_春纱"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://springkill.github.io/en/posts/%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%E6%B1%87%E6%80%BB/"><meta name="twitter:title" content="Remediation Recommendations (Summary) - SpringKill_春纱"><meta name="twitter:description" content="Remediation Recommendations (Summary) - SpringKill_春纱"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.13.10"><link rel="icon" href="/favicon/favicon-light-32.png" sizes="32x32" media="(prefers-color-scheme: light)"><link rel="icon" href="/favicon/favicon-light-128.png" sizes="128x128" media="(prefers-color-scheme: light)"><link rel="icon" href="/favicon/favicon-light-180.png" sizes="180x180" media="(prefers-color-scheme: light)"><link rel="icon" href="/favicon/favicon-light-192.png" sizes="192x192" media="(prefers-color-scheme: light)"><link rel="icon" href="/favicon/favicon-dark-32.png" sizes="32x32" media="(prefers-color-scheme: dark)"><link rel="icon" href="/favicon/favicon-dark-128.png" sizes="128x128" media="(prefers-color-scheme: dark)"><link rel="icon" href="/favicon/favicon-dark-180.png" sizes="180x180" media="(prefers-color-scheme: dark)"><link rel="icon" href="/favicon/favicon-dark-192.png" sizes="192x192" media="(prefers-color-scheme: dark)"><!-- Set the theme before the page is rendered to avoid a flash --><script>(function(){const DEFAULT_THEME = "auto";
const LIGHT_MODE = "light";
const DARK_MODE = "dark";
const AUTO_MODE = "auto";
const BANNER_HEIGHT_EXTEND = 30;
const PAGE_WIDTH = 75;
const configHue = 35;

			// Load the theme from local storage
			const theme = localStorage.getItem('theme') || DEFAULT_THEME;
			switch (theme) {
				case LIGHT_MODE:
					document.documentElement.classList.remove('dark');
					break
				case DARK_MODE:
					document.documentElement.classList.add('dark');
					break
				case AUTO_MODE:
					if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
						document.documentElement.classList.add('dark');
					} else {
						document.documentElement.classList.remove('dark');
					}
			}

			// Load the hue from local storage
			const hue = localStorage.getItem('hue') || configHue;
			document.documentElement.style.setProperty('--hue', hue);

			// calculate the --banner-height-extend, which needs to be a multiple of 4 to avoid blurry text
			let offset = Math.floor(window.innerHeight * (BANNER_HEIGHT_EXTEND / 100));
			offset = offset - offset % 4;
			document.documentElement.style.setProperty('--banner-height-extend', `${offset}px`);
		})();</script><!-- defines global css variables. This will be applied to <html> <body> and some other elements idk why --><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Remediation Recommendations (Summary)","description":"Remediation Recommendations (Summary)","keywords":["Security Notes"],"author":{"@type":"Person","name":"SpringKill","url":"https://springkill.github.io/"},"datePublished":"2024-09-12","inLanguage":"en"}</script><link rel="alternate" type="application/rss+xml" title="SpringKill" href="https://springkill.github.io/rss.xml"><link rel="stylesheet" href="/_astro/Layout.y4KPJ9hc.css">
<link rel="stylesheet" href="/_astro/Layout.DSulWsr7.css">
<link rel="stylesheet" href="/_astro/_page_.v5fR4ItJ.css">
<link rel="stylesheet" href="/_astro/_page_.Br1uOOb7.css">
<link rel="stylesheet" href="/_astro/_page_.ZlghMKVQ.css">
<link rel="stylesheet" href="/_astro/about.BtniRLn_.css">
<style>input.svelte-1wah7ro:focus{outline:0}.search-panel.svelte-1wah7ro{max-height:calc(100vh - 100px);overflow-y:auto}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k){-webkit-appearance:none;height:1.5rem;background-image:var(--color-selection-bar);transition:background-image .15s ease-in-out}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-webkit-slider-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;background:#ffffffb3;box-shadow:none}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-webkit-slider-thumb:hover{background:#fffc}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-webkit-slider-thumb:active{background:#fff9}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-moz-range-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;border-width:0;background:#ffffffb3;box-shadow:none}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-moz-range-thumb:hover{background:#fffc}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-moz-range-thumb:active{background:#fff9}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-ms-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;background:#ffffffb3;box-shadow:none}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-ms-thumb:hover{background:#fffc}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-ms-thumb:active{background:#fff9}
</style><script type="module" src="/_astro/page.Z8IJTFqj.js"></script></head> <body class=" min-h-screen transition " data-overlayscrollbars-initialize data-astro-cid-sckkx6r4 style="--bannerOffset: 15vh;--banner-height-home: 65vh;--banner-height: 35vh;--configHue: 35;--page-width: 75rem;"> <div id="config-carrier" data-hue="35"></div>    <div id="top-row" class="z-50 pointer-events-none relative transition-all duration-700 max-w-[var(--page-width)] px-0 md:px-4 mx-auto"> <div id="navbar-wrapper" class="pointer-events-auto sticky top-0 transition-all"> <div id="navbar" class="z-50 onload-animation"> <div class="absolute h-8 left-0 right-0 -top-8 bg-[var(--card-bg)] transition"></div> <!-- used for onload animation --> <div class="card-base !overflow-visible max-w-[var(--page-width)] h-[4.5rem] !rounded-t-none mx-auto flex items-center justify-between px-4"> <a href="/en/" class="btn-plain scale-animation rounded-lg h-[3.25rem] px-5 font-bold active:scale-95"> <div class="flex flex-row text-[var(--primary)] items-center text-md"> <svg width="1em" height="1em" class="text-[1.75rem] mb-1 mr-2" data-icon="material-symbols:home-outline-rounded">   <symbol id="ai:material-symbols:home-outline-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="M6 19h3v-5q0-.425.288-.712T10 13h4q.425 0 .713.288T15 14v5h3v-9l-6-4.5L6 10zm-2 0v-9q0-.475.213-.9t.587-.7l6-4.5q.525-.4 1.2-.4t1.2.4l6 4.5q.375.275.588.7T20 10v9q0 .825-.588 1.413T18 21h-4q-.425 0-.712-.288T13 20v-5h-2v5q0 .425-.288.713T10 21H6q-.825 0-1.412-.587T4 19m8-6.75"/></symbol><use href="#ai:material-symbols:home-outline-rounded"></use>  </svg> SpringKill_春纱 </div> </a> <div class="hidden md:flex"> <a aria-label="Home" href="/en/" class="btn-plain scale-animation rounded-lg h-11 font-bold px-5 active:scale-95"> <div class="flex items-center"> Home  </div> </a><a aria-label="Archive" href="/en/archive/" class="btn-plain scale-animation rounded-lg h-11 font-bold px-5 active:scale-95"> <div class="flex items-center"> Archive  </div> </a><a aria-label="About" href="/en/about/" class="btn-plain scale-animation rounded-lg h-11 font-bold px-5 active:scale-95"> <div class="flex items-center"> About  </div> </a><a aria-label="Links" href="/en/links/" class="btn-plain scale-animation rounded-lg h-11 font-bold px-5 active:scale-95"> <div class="flex items-center"> Links  </div> </a><a aria-label="GitHub" href="https://github.com/springkill/blog" target="_blank" class="btn-plain scale-animation rounded-lg h-11 font-bold px-5 active:scale-95"> <div class="flex items-center"> GitHub <svg width="1em" height="1em" class="text-[0.875rem] transition -translate-y-[1px] ml-1 text-black/[0.2] dark:text-white/[0.2]" data-icon="fa6-solid:arrow-up-right-from-square">   <symbol id="ai:fa6-solid:arrow-up-right-from-square" viewBox="0 0 512 512"><path fill="currentColor" d="M320 0c-17.7 0-32 14.3-32 32s14.3 32 32 32h82.7L201.4 265.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L448 109.3V192c0 17.7 14.3 32 32 32s32-14.3 32-32V32c0-17.7-14.3-32-32-32zM80 32C35.8 32 0 67.8 0 112v320c0 44.2 35.8 80 80 80h320c44.2 0 80-35.8 80-80V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v112c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V112c0-8.8 7.2-16 16-16h112c17.7 0 32-14.3 32-32s-14.3-32-32-32z"/></symbol><use href="#ai:fa6-solid:arrow-up-right-from-square"></use>  </svg> </div> </a> </div> <div class="flex"> <!--<SearchPanel client:load>--> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();</script><script>(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="2rzatA" component-url="/_astro/Search.DxSrH-Tb.js" component-export="default" renderer-url="/_astro/client.svelte.b-cV3x58.js" props="{}" ssr client="only" opts="{&quot;name&quot;:&quot;Search&quot;,&quot;value&quot;:&quot;svelte&quot;}"></astro-island> <button aria-label="Display Settings" class="btn-plain scale-animation rounded-lg h-11 w-11 active:scale-90" id="display-settings-switch"> <svg width="1em" height="1em" class="text-[1.25rem]" data-icon="material-symbols:palette-outline">   <symbol id="ai:material-symbols:palette-outline" viewBox="0 0 24 24"><path fill="currentColor" d="M12 22q-2.05 0-3.875-.788t-3.187-2.15t-2.15-3.187T2 12q0-2.075.813-3.9t2.2-3.175T8.25 2.788T12.2 2q2 0 3.775.688t3.113 1.9t2.125 2.875T22 11.05q0 2.875-1.75 4.413T16 17h-1.85q-.225 0-.312.125t-.088.275q0 .3.375.863t.375 1.287q0 1.25-.687 1.85T12 22m-5.5-9q.65 0 1.075-.425T8 11.5t-.425-1.075T6.5 10t-1.075.425T5 11.5t.425 1.075T6.5 13m3-4q.65 0 1.075-.425T11 7.5t-.425-1.075T9.5 6t-1.075.425T8 7.5t.425 1.075T9.5 9m5 0q.65 0 1.075-.425T16 7.5t-.425-1.075T14.5 6t-1.075.425T13 7.5t.425 1.075T14.5 9m3 4q.65 0 1.075-.425T19 11.5t-.425-1.075T17.5 10t-1.075.425T16 11.5t.425 1.075T17.5 13M12 20q.225 0 .363-.125t.137-.325q0-.35-.375-.825T11.75 17.3q0-1.05.725-1.675T14.25 15H16q1.65 0 2.825-.962T20 11.05q0-3.025-2.312-5.038T12.2 4Q8.8 4 6.4 6.325T4 12q0 3.325 2.338 5.663T12 20"/></symbol><use href="#ai:material-symbols:palette-outline"></use>  </svg> </button> <astro-island uid="Zu2GML" component-url="/_astro/LanguageSwitch.B0mRFHIn.js" component-export="default" renderer-url="/_astro/client.svelte.b-cV3x58.js" props="{}" ssr client="only" opts="{&quot;name&quot;:&quot;LanguageSwitch&quot;,&quot;value&quot;:&quot;svelte&quot;}"></astro-island> <astro-island uid="KLIX7" component-url="/_astro/LightDarkSwitch.BvS49jLu.js" component-export="default" renderer-url="/_astro/client.svelte.b-cV3x58.js" props="{}" ssr client="only" opts="{&quot;name&quot;:&quot;LightDarkSwitch&quot;,&quot;value&quot;:&quot;svelte&quot;}"></astro-island> <button aria-label="Menu" name="Nav Menu" class="btn-plain scale-animation rounded-lg w-11 h-11 active:scale-90 md:!hidden" id="nav-menu-switch"> <svg width="1em" height="1em" class="text-[1.25rem]" data-icon="material-symbols:menu-rounded">   <symbol id="ai:material-symbols:menu-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="M4 18q-.425 0-.712-.288T3 17t.288-.712T4 16h16q.425 0 .713.288T21 17t-.288.713T20 18zm0-5q-.425 0-.712-.288T3 12t.288-.712T4 11h16q.425 0 .713.288T21 12t-.288.713T20 13zm0-5q-.425 0-.712-.288T3 7t.288-.712T4 6h16q.425 0 .713.288T21 7t-.288.713T20 8z"/></symbol><use href="#ai:material-symbols:menu-rounded"></use>  </svg> </button> </div> <div id="nav-menu-panel" class="float-panel float-panel-closed absolute transition-all fixed right-4 px-2 py-2"> <a href="/en/" class="group flex justify-between items-center py-2 pl-3 pr-1 rounded-lg gap-8
            hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)] transition
        "> <div class="transition text-black/75 dark:text-white/75 font-bold group-hover:text-[var(--primary)] group-active:text-[var(--primary)]"> Home </div> <svg width="1em" height="1em" class="transition text-[1.25rem] text-[var(--primary)]" data-icon="material-symbols:chevron-right-rounded">   <symbol id="ai:material-symbols:chevron-right-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="M12.6 12L8.7 8.1q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275l4.6 4.6q.15.15.213.325t.062.375t-.062.375t-.213.325l-4.6 4.6q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7z"/></symbol><use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg>  </a><a href="/en/archive/" class="group flex justify-between items-center py-2 pl-3 pr-1 rounded-lg gap-8
            hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)] transition
        "> <div class="transition text-black/75 dark:text-white/75 font-bold group-hover:text-[var(--primary)] group-active:text-[var(--primary)]"> Archive </div> <svg width="1em" height="1em" viewBox="0 0 24 24" class="transition text-[1.25rem] text-[var(--primary)]" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg>  </a><a href="/en/about/" class="group flex justify-between items-center py-2 pl-3 pr-1 rounded-lg gap-8
            hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)] transition
        "> <div class="transition text-black/75 dark:text-white/75 font-bold group-hover:text-[var(--primary)] group-active:text-[var(--primary)]"> About </div> <svg width="1em" height="1em" viewBox="0 0 24 24" class="transition text-[1.25rem] text-[var(--primary)]" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg>  </a><a href="/en/links/" class="group flex justify-between items-center py-2 pl-3 pr-1 rounded-lg gap-8
            hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)] transition
        "> <div class="transition text-black/75 dark:text-white/75 font-bold group-hover:text-[var(--primary)] group-active:text-[var(--primary)]"> Links </div> <svg width="1em" height="1em" viewBox="0 0 24 24" class="transition text-[1.25rem] text-[var(--primary)]" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg>  </a><a href="https://github.com/springkill/blog" class="group flex justify-between items-center py-2 pl-3 pr-1 rounded-lg gap-8
            hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)] transition
        " target="_blank"> <div class="transition text-black/75 dark:text-white/75 font-bold group-hover:text-[var(--primary)] group-active:text-[var(--primary)]"> GitHub </div>  <svg width="1em" height="1em" viewBox="0 0 512 512" class="transition text-[0.75rem] text-black/25 dark:text-white/25 -translate-x-1" data-icon="fa6-solid:arrow-up-right-from-square">   <use href="#ai:fa6-solid:arrow-up-right-from-square"></use>  </svg> </a> </div> <astro-island uid="XtJQo" component-url="/_astro/DisplaySettings.kvnkYRCI.js" component-export="default" renderer-url="/_astro/client.svelte.b-cV3x58.js" props="{}" ssr client="only" opts="{&quot;name&quot;:&quot;DisplaySettings&quot;,&quot;value&quot;:&quot;svelte&quot;}"></astro-island> </div> </div> <script type="module">function c(){localStorage.theme==="dark"?(document.documentElement.classList.remove("dark"),localStorage.theme="light"):(document.documentElement.classList.add("dark"),localStorage.theme="dark")}function o(){let t=document.getElementById("scheme-switch");t&&(t.onclick=function(){c()});let n=document.getElementById("display-settings-switch");n&&(n.onclick=function(){let e=document.getElementById("display-setting");e&&e.classList.toggle("float-panel-closed")});let l=document.getElementById("nav-menu-switch");l&&(l.onclick=function(){let e=document.getElementById("nav-menu-panel");e&&e.classList.toggle("float-panel-closed")})}o();</script> <script>(function(){const scriptUrl = "/pagefind/pagefind.js";

async function loadPagefind() {
    try {
        const response = await fetch(scriptUrl, { method: 'HEAD' });
        if (!response.ok) {
            throw new Error(`Pagefind script not found: ${response.status}`);
        }

        const pagefind = await import(scriptUrl);

        await pagefind.options({
            excerptLength: 20
        });

        window.pagefind = pagefind;

        document.dispatchEvent(new CustomEvent('pagefindready'));
        console.log('Pagefind loaded and initialized successfully, event dispatched.');
    } catch (error) {
        console.error('Failed to load Pagefind:', error);
        window.pagefind = {
            search: () => Promise.resolve({ results: [] }),
            options: () => Promise.resolve(),
        };
        document.dispatchEvent(new CustomEvent('pagefindloaderror'));
        console.log('Pagefind load error, event dispatched.');
    }
}

if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', loadPagefind);
} else {
    loadPagefind();
}
})();</script> </div> </div>   <div class="absolute w-full z-30 pointer-events-none" style="top: 5.5rem"> <!-- The pointer-events-none here prevent blocking the click event of the TOC --> <div class="relative max-w-[var(--page-width)] mx-auto pointer-events-auto"> <div id="main-grid" class="transition duration-700 w-full left-0 right-0 grid grid-cols-[17.5rem_auto] grid-rows-[auto_1fr_auto] lg:grid-rows-[auto]
    mx-auto gap-4 px-0 md:px-4"> <!-- Banner image credit -->  <div id="sidebar" class="mb-4 row-start-2 row-end-3 col-span-2 lg:row-start-1 lg:row-end-2 lg:col-span-1 lg:max-w-[17.5rem] onload-animation w-full"> <div class="flex flex-col w-full gap-4 mb-4"> <div class="card-base p-3"> <a aria-label="Go to About Page" href="/en/about/" class="group block relative mx-auto mt-1 lg:mx-0 lg:mt-0 mb-3
       max-w-[12rem] lg:max-w-none overflow-hidden rounded-xl active:scale-95"> <div class="absolute transition pointer-events-none group-hover:bg-black/30 group-active:bg-black/50
        w-full h-full z-50 flex items-center justify-center"> <svg width="1.13em" height="1em" class="transition opacity-0 scale-90 group-hover:scale-100 group-hover:opacity-100 text-white text-5xl" data-icon="fa6-regular:address-card">   <symbol id="ai:fa6-regular:address-card" viewBox="0 0 576 512"><path fill="currentColor" d="M512 80c8.8 0 16 7.2 16 16v320c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V96c0-8.8 7.2-16 16-16zM64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h448c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64zm144 224a64 64 0 1 0 0-128a64 64 0 1 0 0 128m-32 32c-44.2 0-80 35.8-80 80c0 8.8 7.2 16 16 16h192c8.8 0 16-7.2 16-16c0-44.2-35.8-80-80-80zm200-144c-13.3 0-24 10.7-24 24s10.7 24 24 24h80c13.3 0 24-10.7 24-24s-10.7-24-24-24zm0 96c-13.3 0-24 10.7-24 24s10.7 24 24 24h80c13.3 0 24-10.7 24-24s-10.7-24-24-24z"/></symbol><use href="#ai:fa6-regular:address-card"></use>  </svg> </div> <div class="mx-auto lg:w-full h-full lg:mt-0  overflow-hidden relative"> <div class="transition absolute inset-0 dark:bg-black/10 bg-opacity-50 pointer-events-none"></div>  <img src="/head.jpg" alt="Profile Image of the Author" class="w-full h-full object-cover" style="object-position: center"> </div> </a> <div class="px-2"> <div class="font-bold text-xl text-center mb-1 dark:text-neutral-50 transition">SpringKill</div> <div class="h-1 w-5 bg-[var(--primary)] mx-auto rounded-full mb-2 transition"></div> <div class="text-center text-neutral-400 mb-2.5 transition">SpringKill&#39;s blog</div> <div class="flex flex-wrap gap-2 justify-center mb-1">  <a rel="me" aria-label="GitHub" href="https://github.com/springkill" target="_blank" class="btn-regular rounded-lg h-10 gap-2 px-3 font-bold active:scale-95"> <svg width="0.97em" height="1em" class="text-[1.5rem]" data-icon="fa6-brands:github">   <symbol id="ai:fa6-brands:github" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2"/></symbol><use href="#ai:fa6-brands:github"></use>  </svg> GitHub </a> </div> </div> </div> </div> <div id="sidebar-sticky" class="transition-all duration-700 flex flex-col w-full gap-4 top-4 sticky top-4"> <widget-layout data-id="categories" data-is-collapsed="true" class="pb-4 card-base onload-animation" style="animation-delay: 150ms; --collapsedHeight: 7.5rem;" data-astro-cid-ucso7hve="true"> <div class="font-bold transition text-lg text-neutral-900 dark:text-neutral-100 relative ml-8 mt-4 mb-2
        before:w-1 before:h-4 before:rounded-md before:bg-[var(--primary)]
        before:absolute before:left-[-16px] before:top-[5.5px]" data-astro-cid-ucso7hve style="--collapsedHeight: 7.5rem;">Categories</div> <div id="categories" class="collapse-wrapper px-4 overflow-hidden collapsed" data-astro-cid-ucso7hve style="--collapsedHeight: 7.5rem;"> <a href="/en/archive/?uncategorized=true" aria-label="View all posts in the Uncategorized category"> <button class="
            w-full
            h-10
            rounded-lg
            bg-none
            hover:bg-[var(--btn-plain-bg-hover)]
            active:bg-[var(--btn-plain-bg-active)]
            transition-all
            pl-2
            hover:pl-3
            
            text-neutral-700
            hover:text-[var(--primary)]
            dark:text-neutral-300
            dark:hover:text-[var(--primary)]
        "> <div class="flex items-center justify-between relative mr-2"> <div class="overflow-hidden text-left whitespace-nowrap overflow-ellipsis  "> Uncategorized </div> <div class="transition px-2 h-7 ml-4 min-w-[2rem] rounded-lg text-sm font-bold
                    text-[var(--btn-content)] dark:text-[var(--deep-text)]
                    bg-[var(--btn-regular-bg)] dark:bg-[var(--primary)]
                    flex items-center justify-center"> 1 </div> </div> </button> </a><a href="/en/archive/?category=2023_CVE" aria-label="View all posts in the 2023_CVE category"> <button class="
            w-full
            h-10
            rounded-lg
            bg-none
            hover:bg-[var(--btn-plain-bg-hover)]
            active:bg-[var(--btn-plain-bg-active)]
            transition-all
            pl-2
            hover:pl-3
            
            text-neutral-700
            hover:text-[var(--primary)]
            dark:text-neutral-300
            dark:hover:text-[var(--primary)]
        "> <div class="flex items-center justify-between relative mr-2"> <div class="overflow-hidden text-left whitespace-nowrap overflow-ellipsis  "> 2023_CVE </div> <div class="transition px-2 h-7 ml-4 min-w-[2rem] rounded-lg text-sm font-bold
                    text-[var(--btn-content)] dark:text-[var(--deep-text)]
                    bg-[var(--btn-regular-bg)] dark:bg-[var(--primary)]
                    flex items-center justify-center"> 6 </div> </div> </button> </a><a href="/en/archive/?category=2024_CVE" aria-label="View all posts in the 2024_CVE category"> <button class="
            w-full
            h-10
            rounded-lg
            bg-none
            hover:bg-[var(--btn-plain-bg-hover)]
            active:bg-[var(--btn-plain-bg-active)]
            transition-all
            pl-2
            hover:pl-3
            
            text-neutral-700
            hover:text-[var(--primary)]
            dark:text-neutral-300
            dark:hover:text-[var(--primary)]
        "> <div class="flex items-center justify-between relative mr-2"> <div class="overflow-hidden text-left whitespace-nowrap overflow-ellipsis  "> 2024_CVE </div> <div class="transition px-2 h-7 ml-4 min-w-[2rem] rounded-lg text-sm font-bold
                    text-[var(--btn-content)] dark:text-[var(--deep-text)]
                    bg-[var(--btn-regular-bg)] dark:bg-[var(--primary)]
                    flex items-center justify-center"> 1 </div> </div> </button> </a><a href="/en/archive/?category=2024_VULN" aria-label="View all posts in the 2024_VULN category"> <button class="
            w-full
            h-10
            rounded-lg
            bg-none
            hover:bg-[var(--btn-plain-bg-hover)]
            active:bg-[var(--btn-plain-bg-active)]
            transition-all
            pl-2
            hover:pl-3
            
            text-neutral-700
            hover:text-[var(--primary)]
            dark:text-neutral-300
            dark:hover:text-[var(--primary)]
        "> <div class="flex items-center justify-between relative mr-2"> <div class="overflow-hidden text-left whitespace-nowrap overflow-ellipsis  "> 2024_VULN </div> <div class="transition px-2 h-7 ml-4 min-w-[2rem] rounded-lg text-sm font-bold
                    text-[var(--btn-content)] dark:text-[var(--deep-text)]
                    bg-[var(--btn-regular-bg)] dark:bg-[var(--primary)]
                    flex items-center justify-center"> 1 </div> </div> </button> </a><a href="/en/archive/?category=Notes%20%2F%20Misc" aria-label="View all posts in the Notes / Misc category"> <button class="
            w-full
            h-10
            rounded-lg
            bg-none
            hover:bg-[var(--btn-plain-bg-hover)]
            active:bg-[var(--btn-plain-bg-active)]
            transition-all
            pl-2
            hover:pl-3
            
            text-neutral-700
            hover:text-[var(--primary)]
            dark:text-neutral-300
            dark:hover:text-[var(--primary)]
        "> <div class="flex items-center justify-between relative mr-2"> <div class="overflow-hidden text-left whitespace-nowrap overflow-ellipsis  "> Notes / Misc </div> <div class="transition px-2 h-7 ml-4 min-w-[2rem] rounded-lg text-sm font-bold
                    text-[var(--btn-content)] dark:text-[var(--deep-text)]
                    bg-[var(--btn-regular-bg)] dark:bg-[var(--primary)]
                    flex items-center justify-center"> 2 </div> </div> </button> </a><a href="/en/archive/?category=Notes%20%2F%20Tool%20Analysis" aria-label="View all posts in the Notes / Tool Analysis category"> <button class="
            w-full
            h-10
            rounded-lg
            bg-none
            hover:bg-[var(--btn-plain-bg-hover)]
            active:bg-[var(--btn-plain-bg-active)]
            transition-all
            pl-2
            hover:pl-3
            
            text-neutral-700
            hover:text-[var(--primary)]
            dark:text-neutral-300
            dark:hover:text-[var(--primary)]
        "> <div class="flex items-center justify-between relative mr-2"> <div class="overflow-hidden text-left whitespace-nowrap overflow-ellipsis  "> Notes / Tool Analysis </div> <div class="transition px-2 h-7 ml-4 min-w-[2rem] rounded-lg text-sm font-bold
                    text-[var(--btn-content)] dark:text-[var(--deep-text)]
                    bg-[var(--btn-regular-bg)] dark:bg-[var(--primary)]
                    flex items-center justify-center"> 1 </div> </div> </button> </a><a href="/en/archive/?category=Top50VulnsToRCE_2023" aria-label="View all posts in the Top50VulnsToRCE_2023 category"> <button class="
            w-full
            h-10
            rounded-lg
            bg-none
            hover:bg-[var(--btn-plain-bg-hover)]
            active:bg-[var(--btn-plain-bg-active)]
            transition-all
            pl-2
            hover:pl-3
            
            text-neutral-700
            hover:text-[var(--primary)]
            dark:text-neutral-300
            dark:hover:text-[var(--primary)]
        "> <div class="flex items-center justify-between relative mr-2"> <div class="overflow-hidden text-left whitespace-nowrap overflow-ellipsis  "> Top50VulnsToRCE_2023 </div> <div class="transition px-2 h-7 ml-4 min-w-[2rem] rounded-lg text-sm font-bold
                    text-[var(--btn-content)] dark:text-[var(--deep-text)]
                    bg-[var(--btn-regular-bg)] dark:bg-[var(--primary)]
                    flex items-center justify-center"> 1 </div> </div> </button> </a> </div> <div class="expand-btn px-4 -mb-2" data-astro-cid-ucso7hve style="--collapsedHeight: 7.5rem;"> <button class="btn-plain rounded-lg w-full h-9" data-astro-cid-ucso7hve style="--collapsedHeight: 7.5rem;"> <div class="text-[var(--primary)] flex items-center justify-center gap-2 -translate-x-2" data-astro-cid-ucso7hve style="--collapsedHeight: 7.5rem;"> <svg width="1em" height="1em" class="text-[1.75rem]" data-astro-cid-ucso7hve="true" data-icon="material-symbols:more-horiz">   <symbol id="ai:material-symbols:more-horiz" viewBox="0 0 24 24"><path fill="currentColor" d="M6 14q-.825 0-1.412-.587T4 12t.588-1.412T6 10t1.413.588T8 12t-.587 1.413T6 14m6 0q-.825 0-1.412-.587T10 12t.588-1.412T12 10t1.413.588T14 12t-.587 1.413T12 14m6 0q-.825 0-1.412-.587T16 12t.588-1.412T18 10t1.413.588T20 12t-.587 1.413T18 14"/></symbol><use href="#ai:material-symbols:more-horiz"></use>  </svg> More </div> </button> </div> </widget-layout>  <script type="module">class d extends HTMLElement{constructor(){if(super(),this.dataset.isCollapsed!=="true")return;const e=this.dataset.id,t=this.querySelector(".expand-btn"),s=this.querySelector(`#${e}`);t.addEventListener("click",()=>{s.classList.remove("collapsed"),t.classList.add("hidden")})}}customElements.get("widget-layout")||customElements.define("widget-layout",d);</script> <widget-layout data-id="tags" data-is-collapsed="false" class="pb-4 card-base onload-animation" style="animation-delay: 200ms; --collapsedHeight: 7.5rem;" data-astro-cid-ucso7hve="true"> <div class="font-bold transition text-lg text-neutral-900 dark:text-neutral-100 relative ml-8 mt-4 mb-2
        before:w-1 before:h-4 before:rounded-md before:bg-[var(--primary)]
        before:absolute before:left-[-16px] before:top-[5.5px]" data-astro-cid-ucso7hve style="--collapsedHeight: 7.5rem;">Tags</div> <div id="tags" class="collapse-wrapper px-4 overflow-hidden" data-astro-cid-ucso7hve style="--collapsedHeight: 7.5rem;">  <div class="flex gap-2 flex-wrap"> <a href="/en/archive/?tag=Code%20Audit" aria-label="View all posts with the Code Audit tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  Code Audit </a><a href="/en/archive/?tag=Security%20Notes" aria-label="View all posts with the Security Notes tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  Security Notes </a><a href="/en/archive/?tag=Tool%20Analysis" aria-label="View all posts with the Tool Analysis tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  Tool Analysis </a><a href="/en/archive/?tag=Top50VulnsToRCE_2023" aria-label="View all posts with the Top50VulnsToRCE_2023 tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  Top50VulnsToRCE_2023 </a> </div>  </div>  </widget-layout>   </div> </div> <main id="swup-container" class="transition-swup-fade col-span-2 lg:col-span-1 overflow-hidden"> <div id="content-wrapper" class="onload-animation"> <!-- the overflow-hidden here prevent long text break the layout--> <!-- make id different from windows.swup global property -->   <div class="flex w-full rounded-[var(--radius-large)] overflow-hidden relative mb-4"> <div id="post-container" class="card-base z-10 px-6 md:px-9 pt-6 pb-4 relative w-full "> <!-- word count and reading time --> <div class="flex flex-row text-black/30 dark:text-white/30 gap-5 mb-3 transition onload-animation"> <div class="flex flex-row items-center"> <div class="transition h-6 w-6 rounded-md bg-black/5 dark:bg-white/10 text-black/50 dark:text-white/50 flex items-center justify-center mr-2"> <svg width="1em" height="1em" data-icon="material-symbols:notes-rounded">   <symbol id="ai:material-symbols:notes-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="M4 18q-.425 0-.712-.288T3 17t.288-.712T4 16h10q.425 0 .713.288T15 17t-.288.713T14 18zm0-5q-.425 0-.712-.288T3 12t.288-.712T4 11h16q.425 0 .713.288T21 12t-.288.713T20 13zm0-5q-.425 0-.712-.288T3 7t.288-.712T4 6h16q.425 0 .713.288T21 7t-.288.713T20 8z"/></symbol><use href="#ai:material-symbols:notes-rounded"></use>  </svg> </div> <div class="text-sm"> 2738  words </div> </div> <div class="flex flex-row items-center"> <div class="transition h-6 w-6 rounded-md bg-black/5 dark:bg-white/10 text-black/50 dark:text-white/50 flex items-center justify-center mr-2"> <svg width="1em" height="1em" data-icon="material-symbols:schedule-outline-rounded">   <symbol id="ai:material-symbols:schedule-outline-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="M13 11.6V8q0-.425-.288-.712T12 7t-.712.288T11 8v3.975q0 .2.075.388t.225.337l3.3 3.3q.275.275.7.275T16 16t.275-.7t-.275-.7zM12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.325 0 5.663-2.337T20 12t-2.337-5.663T12 4T6.337 6.338T4 12t2.338 5.663T12 20"/></symbol><use href="#ai:material-symbols:schedule-outline-rounded"></use>  </svg> </div> <div class="text-sm"> 14  minutes </div> </div> </div> <!-- title --> <div class="relative onload-animation"> <div data-pagefind-body data-pagefind-weight="10" data-pagefind-meta="title" class="transition w-full block font-bold mb-3
                    text-3xl md:text-[2.25rem]/[2.75rem]
                    text-black/90 dark:text-white/90
                    md:before:w-1 before:h-5 before:rounded-md before:bg-[var(--primary)]
                    before:absolute before:top-[0.75rem] before:left-[-1.125rem]
                "> Remediation Recommendations (Summary) </div> </div> <!-- metadata --> <div class="onload-animation"> <div class="flex flex-wrap text-neutral-500 dark:text-neutral-400 items-center gap-4 gap-x-4 gap-y-2 mb-5"> <!-- publish date --> <div class="flex items-center"> <div class="meta-icon"> <svg width="1em" height="1em" class="text-xl" data-icon="material-symbols:calendar-today-outline-rounded">   <symbol id="ai:material-symbols:calendar-today-outline-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="M5 22q-.825 0-1.412-.587T3 20V6q0-.825.588-1.412T5 4h1V3q0-.425.288-.712T7 2t.713.288T8 3v1h8V3q0-.425.288-.712T17 2t.713.288T18 3v1h1q.825 0 1.413.588T21 6v14q0 .825-.587 1.413T19 22zm0-2h14V10H5zM5 8h14V6H5zm0 0V6z"/></symbol><use href="#ai:material-symbols:calendar-today-outline-rounded"></use>  </svg> </div> <span class="text-50 text-sm font-medium">2024-09-12</span> </div> <!-- update date -->  <!-- categories --> <div class="flex items-center"> <div class="meta-icon"> <svg width="1em" height="1em" class="text-xl" data-icon="material-symbols:book-2-outline-rounded">   <symbol id="ai:material-symbols:book-2-outline-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="M6 15.325q.35-.175.725-.25T7.5 15H8V4h-.5q-.625 0-1.062.438T6 5.5zM10 15h8V4h-8zm-4 .325V4zM7.5 22q-1.45 0-2.475-1.025T4 18.5v-13q0-1.45 1.025-2.475T7.5 2H18q.825 0 1.413.587T20 4v12.525q0 .2-.162.363t-.588.362q-.35.175-.55.5t-.2.75t.2.763t.55.487t.55.413t.2.562v.25q0 .425-.288.725T19 22zm0-2h9.325q-.15-.35-.237-.712T16.5 18.5q0-.4.075-.775t.25-.725H7.5q-.65 0-1.075.438T6 18.5q0 .65.425 1.075T7.5 20"/></symbol><use href="#ai:material-symbols:book-2-outline-rounded"></use>  </svg> </div> <div class="flex flex-row flex-nowrap items-center"> <a href="/en/archive/?category=Notes%20%2F%20Misc" aria-label="View all posts in the Notes / Misc category" class="link-lg transition text-50 text-sm font-medium
                            hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> Notes / Misc </a> </div> </div> <!-- tags --> <div class="items-center flex"> <div class="meta-icon"> <svg width="1em" height="1em" class="text-xl" data-icon="material-symbols:tag-rounded">   <symbol id="ai:material-symbols:tag-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="m9 16l-.825 3.275q-.075.325-.325.525t-.6.2q-.475 0-.775-.375T6.3 18.8L7 16H4.275q-.5 0-.8-.387T3.3 14.75q.075-.35.35-.55t.625-.2H7.5l1-4H5.775q-.5 0-.8-.387T4.8 8.75q.075-.35.35-.55t.625-.2H9l.825-3.275Q9.9 4.4 10.15 4.2t.6-.2q.475 0 .775.375t.175.825L11 8h4l.825-3.275q.075-.325.325-.525t.6-.2q.475 0 .775.375t.175.825L17 8h2.725q.5 0 .8.387t.175.863q-.075.35-.35.55t-.625.2H16.5l-1 4h2.725q.5 0 .8.388t.175.862q-.075.35-.35.55t-.625.2H15l-.825 3.275q-.075.325-.325.525t-.6.2q-.475 0-.775-.375T12.3 18.8L13 16zm.5-2h4l1-4h-4z"/></symbol><use href="#ai:material-symbols:tag-rounded"></use>  </svg> </div> <div class="flex flex-row flex-nowrap items-center"> <div class="hidden mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/en/archive/?tag=Security%20Notes" aria-label="View all posts with the Security Notes tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> Security Notes </a>  </div> </div> </div> <div class="border-[var(--line-divider)] border-dashed border-b-[1px] mb-5"></div> </div> <!-- always show cover as long as it has one -->  <div data-pagefind-body class="prose dark:prose-invert prose-base !max-w-none custom-md mb-6 markdown-content onload-animation"> <!--<div class="prose dark:prose-invert max-w-none custom-md">--> <!--<div class="max-w-none custom-md">-->  <section><h1 id="web-vulnerabilities">Web Vulnerabilities<a class="anchor" href="#web-vulnerabilities"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h1><p>Mainly for convenient copy/paste when writing reports.</p><section><h2 id="reflected-xss">Reflected XSS<a class="anchor" href="#reflected-xss"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
Reflected Cross-Site Scripting (XSS) is a common web vulnerability. It happens when an attacker injects a malicious script into an application, and the application reflects it back to the user without proper sanitization or validation. This allows the script to execute in the victim’s browser, potentially leading to cookie theft, session hijacking, page defacement, phishing, etc.</p><p>Example (user input is directly concatenated into HTML):</p><div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.4fsv9.css"><script type="module" src="/_astro/ec.g1fg5.js"></script><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:121ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.io.IOException;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.io.PrintWriter;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> javax.servlet.ServletException;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> javax.servlet.http.HttpServlet;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> javax.servlet.http.HttpServletRequest;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> javax.servlet.http.HttpServletResponse;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">VulnerableServlet</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">extends</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">HttpServlet</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">protected</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">doGet</span><span style="--0:#E1E4E8;--1:#E1E4E8">(HttpServletRequest </span><span style="--0:#FFAB70;--1:#FFAB70">request</span><span style="--0:#E1E4E8;--1:#E1E4E8">, HttpServletResponse </span><span style="--0:#FFAB70;--1:#FFAB70">response</span><span style="--0:#E1E4E8;--1:#E1E4E8">) </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> ServletException, IOException {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">String userInput </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> request.</span><span style="--0:#B392F0;--1:#B392F0">getParameter</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"input"</span><span style="--0:#E1E4E8;--1:#E1E4E8">); </span><span style="--0:#99A0A6;--1:#99A0A6">// Vulnerable to XSS</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">response.</span><span style="--0:#B392F0;--1:#B392F0">setContentType</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"text/html"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">PrintWriter out </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> response.</span><span style="--0:#B392F0;--1:#B392F0">getWriter</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">out.</span><span style="--0:#B392F0;--1:#B392F0">println</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"&#x3C;html>"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">out.</span><span style="--0:#B392F0;--1:#B392F0">println</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"&#x3C;head>&#x3C;title>Reflection XSS Vulnerability Example&#x3C;/title>&#x3C;/head>"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">out.</span><span style="--0:#B392F0;--1:#B392F0">println</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"&#x3C;body>"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">17</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">out.</span><span style="--0:#B392F0;--1:#B392F0">println</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"&#x3C;h1>Hello, "</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">+</span><span style="--0:#E1E4E8;--1:#E1E4E8"> userInput </span><span style="--0:#F97583;--1:#F97583">+</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#9ECBFF;--1:#9ECBFF">"!&#x3C;/h1>"</span><span style="--0:#E1E4E8;--1:#E1E4E8">); </span><span style="--0:#99A0A6;--1:#99A0A6">// Vulnerable to XSS</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">18</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">out.</span><span style="--0:#B392F0;--1:#B392F0">println</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"&#x3C;/body>"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">19</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">out.</span><span style="--0:#B392F0;--1:#B392F0">println</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"&#x3C;/html>"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">20</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">out.</span><span style="--0:#B392F0;--1:#B392F0">close</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">21</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">22</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div><p><strong>Recommendations:</strong></p><ol>
<li>Input validation &#x26; sanitization: validate and sanitize all user input before rendering it. Ensure input does not contain HTML/JavaScript or other executable content.</li>
<li>Output encoding: encode user input when outputting it into HTML so the browser won’t interpret it as executable code (use framework-provided encoding functions/libraries).</li>
<li>Content Security Policy (CSP): enforce a strict CSP to control which resources (scripts/styles/fonts) may load. Restricting script sources helps mitigate XSS impact.</li>
<li>Use mature frameworks/libraries: leverage frameworks/libraries with built-in XSS protections (automatic encoding, safer templating, etc.).</li>
</ol><p>Example: HTML-escape user input with <code>StringEscapeUtils.escapeHtml4()</code> (Apache Commons Text) before rendering:</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:104ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> org.apache.commons.text.StringEscapeUtils; </span><span style="--0:#99A0A6;--1:#99A0A6">// Using Apache Commons Text library for HTML escaping</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">XSSExample</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">static</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">main</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#F97583;--1:#F97583">String</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#FFAB70;--1:#FFAB70">args</span><span style="--0:#E1E4E8;--1:#E1E4E8">) {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span class="indent">        </span><span style="--0:#99A0A6;--1:#99A0A6">// Simulated user input (potentially malicious)</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">String userInput </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#9ECBFF;--1:#9ECBFF">"&#x3C;script>alert('XSS Attack!');&#x3C;/script>"</span><span style="--0:#E1E4E8;--1:#E1E4E8">;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent">        </span><span style="--0:#99A0A6;--1:#99A0A6">// Encode user input to prevent XSS</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">String safeOutput </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> StringEscapeUtils.</span><span style="--0:#B392F0;--1:#B392F0">escapeHtml4</span><span style="--0:#E1E4E8;--1:#E1E4E8">(userInput);</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span class="indent">        </span><span style="--0:#99A0A6;--1:#99A0A6">// Displaying the safe output</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">System.out.</span><span style="--0:#B392F0;--1:#B392F0">println</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"Safe Output: "</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">+</span><span style="--0:#E1E4E8;--1:#E1E4E8"> safeOutput);</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div></section><section><h2 id="stored-xss">Stored XSS<a class="anchor" href="#stored-xss"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong></p><p><strong>Recommendations:</strong></p></section><section><h2 id="dom-based-xss">DOM-based XSS<a class="anchor" href="#dom-based-xss"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
DOM-based XSS is an attack where malicious code executes in the browser through client-side script (typically JavaScript) manipulating the DOM (Document Object Model). Unlike other XSS types, DOM XSS does not require server-side reflection/storage — it happens when page scripts incorrectly handle untrusted input and inject it into the DOM. This can steal sessions, modify page content, etc.</p><p><strong>Recommendations:</strong></p><ol>
<li>Validate/encode input before DOM insertion: never use untrusted input directly in DOM operations.</li>
<li>Use safe APIs: prefer APIs that do not parse HTML, e.g. <code>textContent</code> instead of <code>innerHTML</code>. Use <code>Element.setAttribute</code> instead of string concatenation.</li>
<li>Use CSP: restrict inline scripts and unauthorized external scripts.</li>
<li>Use framework protections: modern frameworks (React/Angular/Vue) provide XSS mitigations by default when used correctly.</li>
</ol></section><section><h2 id="directory-traversal">Directory Traversal<a class="anchor" href="#directory-traversal"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
Directory traversal (path traversal) allows attackers to access files/directories outside the intended directory by supplying paths like <code>../</code>. This can leak sensitive files (configs/passwords) or allow modification/execution of system files.</p><p>Example (attacker controls <code>filePath</code> like <code>"../../etc/passwd"</code>):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:64ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">DirectoryTraversalVulnerable</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">byte</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#B392F0;--1:#B392F0">readFile</span><span style="--0:#E1E4E8;--1:#E1E4E8">(String </span><span style="--0:#FFAB70;--1:#FFAB70">filePath</span><span style="--0:#E1E4E8;--1:#E1E4E8">) </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> IOException {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">File file </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">File</span><span style="--0:#E1E4E8;--1:#E1E4E8">(filePath);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">FileInputStream fis </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">FileInputStream</span><span style="--0:#E1E4E8;--1:#E1E4E8">(file);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">byte</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] data </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">byte</span><span style="--0:#E1E4E8;--1:#E1E4E8">[(</span><span style="--0:#F97583;--1:#F97583">int</span><span style="--0:#E1E4E8;--1:#E1E4E8">) file.</span><span style="--0:#B392F0;--1:#B392F0">length</span><span style="--0:#E1E4E8;--1:#E1E4E8">()];</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">fis.</span><span style="--0:#B392F0;--1:#B392F0">read</span><span style="--0:#E1E4E8;--1:#E1E4E8">(data);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">fis.</span><span style="--0:#B392F0;--1:#B392F0">close</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">return</span><span style="--0:#E1E4E8;--1:#E1E4E8"> data;</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div><p><strong>Recommendations:</strong></p><ol>
<li>Strict input validation: reject/remove traversal sequences like <code>../</code>.</li>
<li>Use safer file APIs: ensure your file access logic accounts for traversal.</li>
<li>Use allowlists: maintain an allowlist of permitted paths/files.</li>
<li>Least privilege: restrict filesystem permissions for the app user.</li>
<li>Error handling: avoid leaking filesystem structure via errors.</li>
</ol><p>Example: enforce a safe base directory and validate canonical paths:</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:80ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">DirectoryTraversalSafe</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">private</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">final</span><span style="--0:#E1E4E8;--1:#E1E4E8"> String basePath </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#9ECBFF;--1:#9ECBFF">"/var/data/appfiles"</span><span style="--0:#E1E4E8;--1:#E1E4E8">;  </span><span style="--0:#99A0A6;--1:#99A0A6">// safe base path</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">byte</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#B392F0;--1:#B392F0">readFile</span><span style="--0:#E1E4E8;--1:#E1E4E8">(String </span><span style="--0:#FFAB70;--1:#FFAB70">filePath</span><span style="--0:#E1E4E8;--1:#E1E4E8">) </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> IOException {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">File file </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">File</span><span style="--0:#E1E4E8;--1:#E1E4E8">(basePath, filePath);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">if</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (</span><span style="--0:#F97583;--1:#F97583">!</span><span style="--0:#E1E4E8;--1:#E1E4E8">file.</span><span style="--0:#B392F0;--1:#B392F0">getCanonicalPath</span><span style="--0:#E1E4E8;--1:#E1E4E8">().</span><span style="--0:#B392F0;--1:#B392F0">startsWith</span><span style="--0:#E1E4E8;--1:#E1E4E8">(basePath)) {</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#F97583">throw</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">SecurityException</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"Attempted directory traversal attack"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">FileInputStream fis </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">FileInputStream</span><span style="--0:#E1E4E8;--1:#E1E4E8">(file);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">byte</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] data </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">byte</span><span style="--0:#E1E4E8;--1:#E1E4E8">[(</span><span style="--0:#F97583;--1:#F97583">int</span><span style="--0:#E1E4E8;--1:#E1E4E8">) file.</span><span style="--0:#B392F0;--1:#B392F0">length</span><span style="--0:#E1E4E8;--1:#E1E4E8">()];</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">fis.</span><span style="--0:#B392F0;--1:#B392F0">read</span><span style="--0:#E1E4E8;--1:#E1E4E8">(data);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">fis.</span><span style="--0:#B392F0;--1:#B392F0">close</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">return</span><span style="--0:#E1E4E8;--1:#E1E4E8"> data;</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div></section><section><h2 id="sql-injection">SQL Injection<a class="anchor" href="#sql-injection"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
SQL injection allows attackers to inject malicious SQL into queries, leading to auth bypass, data theft/modification/deletion, etc. It typically occurs when user input is concatenated into SQL without proper parameterization.</p><p>Vulnerable example (string concatenation):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:104ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">SqlInjectionVulnerable</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">getUser</span><span style="--0:#E1E4E8;--1:#E1E4E8">(String </span><span style="--0:#FFAB70;--1:#FFAB70">username</span><span style="--0:#E1E4E8;--1:#E1E4E8">) {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">Connection conn </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">;</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">Statement stmt </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">;</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">try</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">conn </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> DriverManager.</span><span style="--0:#B392F0;--1:#B392F0">getConnection</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"jdbc:mysql://localhost/testdb"</span><span style="--0:#E1E4E8;--1:#E1E4E8">, </span><span style="--0:#9ECBFF;--1:#9ECBFF">"user"</span><span style="--0:#E1E4E8;--1:#E1E4E8">, </span><span style="--0:#9ECBFF;--1:#9ECBFF">"password"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">stmt </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> conn.</span><span style="--0:#B392F0;--1:#B392F0">createStatement</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">ResultSet rs </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> stmt.</span><span style="--0:#B392F0;--1:#B392F0">executeQuery</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"SELECT * FROM users WHERE username = '"</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">+</span><span style="--0:#E1E4E8;--1:#E1E4E8"> username </span><span style="--0:#F97583;--1:#F97583">+</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#9ECBFF;--1:#9ECBFF">"'"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#F97583">while</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (rs.</span><span style="--0:#B392F0;--1:#B392F0">next</span><span style="--0:#E1E4E8;--1:#E1E4E8">()) {</span></div></div><div class="ec-line" style="--ecIndent:16ch"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span class="indent">                </span><span style="--0:#99A0A6;--1:#99A0A6">// handle results</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">} </span><span style="--0:#F97583;--1:#F97583">catch</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (SQLException </span><span style="--0:#FFAB70;--1:#FFAB70">e</span><span style="--0:#E1E4E8;--1:#E1E4E8">) {</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">e.</span><span style="--0:#B392F0;--1:#B392F0">printStackTrace</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">} </span><span style="--0:#F97583;--1:#F97583">finally</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#F97583">try</span><span style="--0:#E1E4E8;--1:#E1E4E8"> { </span><span style="--0:#F97583;--1:#F97583">if</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (stmt </span><span style="--0:#F97583;--1:#F97583">!=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">) stmt.</span><span style="--0:#B392F0;--1:#B392F0">close</span><span style="--0:#E1E4E8;--1:#E1E4E8">(); } </span><span style="--0:#F97583;--1:#F97583">catch</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (SQLException </span><span style="--0:#FFAB70;--1:#FFAB70">e</span><span style="--0:#E1E4E8;--1:#E1E4E8">) { }</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#F97583">try</span><span style="--0:#E1E4E8;--1:#E1E4E8"> { </span><span style="--0:#F97583;--1:#F97583">if</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (conn </span><span style="--0:#F97583;--1:#F97583">!=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">) conn.</span><span style="--0:#B392F0;--1:#B392F0">close</span><span style="--0:#E1E4E8;--1:#E1E4E8">(); } </span><span style="--0:#F97583;--1:#F97583">catch</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (SQLException </span><span style="--0:#FFAB70;--1:#FFAB70">e</span><span style="--0:#E1E4E8;--1:#E1E4E8">) { }</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">17</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">18</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">19</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div><p><strong>Recommendations:</strong></p><ol>
<li>Parameterized queries: the most effective protection; prevents SQL structure changes.</li>
<li>Prepared statements: e.g. <code>PreparedStatement</code> in Java; separates query structure from data.</li>
<li>Input validation: reduce attack surface by rejecting suspicious input (not sufficient alone).</li>
<li>Use ORM frameworks: Hibernate/JPA typically use parameterization by default.</li>
<li>Least privilege: limit DB account permissions so impact is reduced if injection succeeds.</li>
</ol><p>Safe example (prepared statement):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:100ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">SqlInjectionSafe</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">getUser</span><span style="--0:#E1E4E8;--1:#E1E4E8">(String </span><span style="--0:#FFAB70;--1:#FFAB70">username</span><span style="--0:#E1E4E8;--1:#E1E4E8">) {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">Connection conn </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">;</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">PreparedStatement pstmt </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">;</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">try</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">conn </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> DriverManager.</span><span style="--0:#B392F0;--1:#B392F0">getConnection</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"jdbc:mysql://localhost/testdb"</span><span style="--0:#E1E4E8;--1:#E1E4E8">, </span><span style="--0:#9ECBFF;--1:#9ECBFF">"user"</span><span style="--0:#E1E4E8;--1:#E1E4E8">, </span><span style="--0:#9ECBFF;--1:#9ECBFF">"password"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">pstmt </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> conn.</span><span style="--0:#B392F0;--1:#B392F0">prepareStatement</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"SELECT * FROM users WHERE username = ?"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">pstmt.</span><span style="--0:#B392F0;--1:#B392F0">setString</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#79B8FF;--1:#79B8FF">1</span><span style="--0:#E1E4E8;--1:#E1E4E8">, username);</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">ResultSet rs </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> pstmt.</span><span style="--0:#B392F0;--1:#B392F0">executeQuery</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#F97583">while</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (rs.</span><span style="--0:#B392F0;--1:#B392F0">next</span><span style="--0:#E1E4E8;--1:#E1E4E8">()) {</span></div></div><div class="ec-line" style="--ecIndent:16ch"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span class="indent">                </span><span style="--0:#99A0A6;--1:#99A0A6">// handle results</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">} </span><span style="--0:#F97583;--1:#F97583">catch</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (SQLException </span><span style="--0:#FFAB70;--1:#FFAB70">e</span><span style="--0:#E1E4E8;--1:#E1E4E8">) {</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">e.</span><span style="--0:#B392F0;--1:#B392F0">printStackTrace</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">} </span><span style="--0:#F97583;--1:#F97583">finally</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#F97583">try</span><span style="--0:#E1E4E8;--1:#E1E4E8"> { </span><span style="--0:#F97583;--1:#F97583">if</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (pstmt </span><span style="--0:#F97583;--1:#F97583">!=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">) pstmt.</span><span style="--0:#B392F0;--1:#B392F0">close</span><span style="--0:#E1E4E8;--1:#E1E4E8">(); } </span><span style="--0:#F97583;--1:#F97583">catch</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (SQLException </span><span style="--0:#FFAB70;--1:#FFAB70">e</span><span style="--0:#E1E4E8;--1:#E1E4E8">) { }</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">17</div></div><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#F97583">try</span><span style="--0:#E1E4E8;--1:#E1E4E8"> { </span><span style="--0:#F97583;--1:#F97583">if</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (conn </span><span style="--0:#F97583;--1:#F97583">!=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">) conn.</span><span style="--0:#B392F0;--1:#B392F0">close</span><span style="--0:#E1E4E8;--1:#E1E4E8">(); } </span><span style="--0:#F97583;--1:#F97583">catch</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (SQLException </span><span style="--0:#FFAB70;--1:#FFAB70">e</span><span style="--0:#E1E4E8;--1:#E1E4E8">) { }</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">18</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">19</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">20</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div></section><section><h2 id="sql-injection-mybatis">SQL Injection (MyBatis)<a class="anchor" href="#sql-injection-mybatis"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
In MyBatis, <code>${}</code> performs string substitution: it directly injects the value into the SQL text (no precompilation/binding like <code>#{}</code>). While <code>${}</code> can be useful for internal trusted variables, using it with untrusted user input can lead to SQL injection.</p><p>Vulnerable mapper (uses <code>${}</code>):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="xml" class="wrap" style="--ecMaxLine:72ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">&#x3C;</span><span style="--0:#85E89D;--1:#85E89D">mapper</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">namespace</span><span style="--0:#E1E4E8;--1:#E1E4E8">=</span><span style="--0:#9ECBFF;--1:#9ECBFF">"com.example.mapper.UserMapper"</span><span style="--0:#E1E4E8;--1:#E1E4E8">></span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">&#x3C;</span><span style="--0:#85E89D;--1:#85E89D">select</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">id</span><span style="--0:#E1E4E8;--1:#E1E4E8">=</span><span style="--0:#9ECBFF;--1:#9ECBFF">"findUserByUsername"</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">resultType</span><span style="--0:#E1E4E8;--1:#E1E4E8">=</span><span style="--0:#9ECBFF;--1:#9ECBFF">"com.example.model.User"</span><span style="--0:#E1E4E8;--1:#E1E4E8">></span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">SELECT * FROM users WHERE username = '${username}'</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">&#x3C;/</span><span style="--0:#85E89D;--1:#85E89D">select</span><span style="--0:#E1E4E8;--1:#E1E4E8">></span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">&#x3C;/</span><span style="--0:#85E89D;--1:#85E89D">mapper</span><span style="--0:#E1E4E8;--1:#E1E4E8">></span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div><p><strong>Recommendations:</strong></p><ol>
<li>Avoid <code>${}</code> for user input: only use it for internal trusted values.</li>
<li>Use <code>#{}</code> parameter binding: uses prepared statements and prevents SQL injection.</li>
<li>Validate/clean inputs: enforce formats/length/range to reduce abuse.</li>
<li>Use MyBatis dynamic SQL: prefer <code>&#x3C;choose></code>, <code>&#x3C;if></code>, <code>&#x3C;when></code>, <code>&#x3C;otherwise></code>, etc., instead of manual string concatenation.</li>
</ol><p>Safe mapper (uses <code>#{}</code>):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="xml" class="wrap" style="--ecMaxLine:95ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">&#x3C;</span><span style="--0:#85E89D;--1:#85E89D">mapper</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">namespace</span><span style="--0:#E1E4E8;--1:#E1E4E8">=</span><span style="--0:#9ECBFF;--1:#9ECBFF">"com.example.mapper.UserMapper"</span><span style="--0:#E1E4E8;--1:#E1E4E8">></span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">&#x3C;</span><span style="--0:#85E89D;--1:#85E89D">select</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">id</span><span style="--0:#E1E4E8;--1:#E1E4E8">=</span><span style="--0:#9ECBFF;--1:#9ECBFF">"findUserByUsername"</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">parameterType</span><span style="--0:#E1E4E8;--1:#E1E4E8">=</span><span style="--0:#9ECBFF;--1:#9ECBFF">"string"</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">resultType</span><span style="--0:#E1E4E8;--1:#E1E4E8">=</span><span style="--0:#9ECBFF;--1:#9ECBFF">"com.example.model.User"</span><span style="--0:#E1E4E8;--1:#E1E4E8">></span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">SELECT * FROM users WHERE username = #{username}</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">&#x3C;/</span><span style="--0:#85E89D;--1:#85E89D">select</span><span style="--0:#E1E4E8;--1:#E1E4E8">></span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">&#x3C;/</span><span style="--0:#85E89D;--1:#85E89D">mapper</span><span style="--0:#E1E4E8;--1:#E1E4E8">></span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div></section><section><h2 id="command-injection">Command Injection<a class="anchor" href="#command-injection"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
Command injection occurs when untrusted input is used to build a system command. Attackers can inject extra commands/arguments to achieve arbitrary command execution, leading to data exposure and system compromise. This often happens when using APIs like <code>Runtime.exec()</code> or <code>ProcessBuilder</code> without strict validation.</p><p><strong>Recommendations:</strong></p><ol>
<li>Avoid executing user input directly: validate and sanitize strictly if unavoidable.</li>
<li>Use safer APIs: keep command and parameters strictly separated (e.g., <code>ProcessBuilder</code> with argument arrays).</li>
<li>Allowlist validation: restrict to known-safe commands/arguments.</li>
<li>Least privilege: run the app with minimal OS permissions.</li>
<li>Use existing security libraries/tools: avoid custom parsing/escaping where possible.</li>
</ol></section><section><h2 id="server-side-request-forgery-ssrf">Server-Side Request Forgery (SSRF)<a class="anchor" href="#server-side-request-forgery-ssrf"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
SSRF allows an attacker to make the server send requests to attacker-chosen targets (internal/external). This can access internal services behind firewalls, bypass IP allowlists, scan ports, and abuse trust relationships.</p><p><strong>Recommendations:</strong></p><ol>
<li>Validate and filter URLs: enforce strict format and allowlist allowed schemes/domains.</li>
<li>Restrict destinations: block private networks/metadata endpoints; restrict ports.</li>
<li>Use safe URL parsing libraries: avoid hand-rolled parsing.</li>
<li>Set timeouts/retries: reduce DoS risk.</li>
<li>Use an egress proxy: centralize filtering/auditing and hide real server IP.</li>
</ol><p>Example: validate host/protocol with an allowlist before fetching:</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:105ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.io.BufferedReader;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.io.InputStreamReader;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.net.HttpURLConnection;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.net.URL;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">SsrfSafeExample</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> String </span><span style="--0:#B392F0;--1:#B392F0">fetchUrlContent</span><span style="--0:#E1E4E8;--1:#E1E4E8">(String </span><span style="--0:#FFAB70;--1:#FFAB70">urlString</span><span style="--0:#E1E4E8;--1:#E1E4E8">) </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> Exception {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">URL url </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">URL</span><span style="--0:#E1E4E8;--1:#E1E4E8">(urlString);</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span class="indent">        </span><span style="--0:#99A0A6;--1:#99A0A6">// Validate URL host/protocol</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">if</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (</span><span style="--0:#F97583;--1:#F97583">!</span><span style="--0:#B392F0;--1:#B392F0">isValidUrl</span><span style="--0:#E1E4E8;--1:#E1E4E8">(url)) {</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#F97583">throw</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">IllegalArgumentException</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"Invalid URL provided"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">HttpURLConnection connection </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (HttpURLConnection) url.</span><span style="--0:#B392F0;--1:#B392F0">openConnection</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">BufferedReader reader </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">BufferedReader</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">InputStreamReader</span><span style="--0:#E1E4E8;--1:#E1E4E8">(connection.</span><span style="--0:#B392F0;--1:#B392F0">getInputStream</span><span style="--0:#E1E4E8;--1:#E1E4E8">()));</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">17</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">18</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">StringBuilder response </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">StringBuilder</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">19</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">String line;</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">20</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">while</span><span style="--0:#E1E4E8;--1:#E1E4E8"> ((line </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> reader.</span><span style="--0:#B392F0;--1:#B392F0">readLine</span><span style="--0:#E1E4E8;--1:#E1E4E8">()) </span><span style="--0:#F97583;--1:#F97583">!=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">) {</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">21</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">response.</span><span style="--0:#B392F0;--1:#B392F0">append</span><span style="--0:#E1E4E8;--1:#E1E4E8">(line);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">22</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">23</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">reader.</span><span style="--0:#B392F0;--1:#B392F0">close</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">24</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">25</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">return</span><span style="--0:#E1E4E8;--1:#E1E4E8"> response.</span><span style="--0:#B392F0;--1:#B392F0">toString</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">26</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">27</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">28</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">private</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">boolean</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">isValidUrl</span><span style="--0:#E1E4E8;--1:#E1E4E8">(URL </span><span style="--0:#FFAB70;--1:#FFAB70">url</span><span style="--0:#E1E4E8;--1:#E1E4E8">) {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">29</div></div><div class="code"><span class="indent">        </span><span style="--0:#99A0A6;--1:#99A0A6">// Example allowlist (customize for your app)</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">30</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">String host </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> url.</span><span style="--0:#B392F0;--1:#B392F0">getHost</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">31</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">String protocol </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> url.</span><span style="--0:#B392F0;--1:#B392F0">getProtocol</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">32</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">return</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#9ECBFF;--1:#9ECBFF">"http"</span><span style="--0:#E1E4E8;--1:#E1E4E8">.</span><span style="--0:#B392F0;--1:#B392F0">equals</span><span style="--0:#E1E4E8;--1:#E1E4E8">(protocol) </span><span style="--0:#F97583;--1:#F97583">&#x26;&#x26;</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (</span><span style="--0:#9ECBFF;--1:#9ECBFF">"example.com"</span><span style="--0:#E1E4E8;--1:#E1E4E8">.</span><span style="--0:#B392F0;--1:#B392F0">equals</span><span style="--0:#E1E4E8;--1:#E1E4E8">(host) </span><span style="--0:#F97583;--1:#F97583">||</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#9ECBFF;--1:#9ECBFF">"api.example.com"</span><span style="--0:#E1E4E8;--1:#E1E4E8">.</span><span style="--0:#B392F0;--1:#B392F0">equals</span><span style="--0:#E1E4E8;--1:#E1E4E8">(host));</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">33</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">34</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div></section><section><h2 id="code-injection">Code Injection<a class="anchor" href="#code-injection"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
Code injection happens when untrusted input is passed into an interpreter/executor (e.g., <code>eval()</code>, <code>Runtime.exec()</code>) and runs as code. Impact ranges from data tampering to full system compromise.</p><p><strong>Recommendations:</strong></p><ol>
<li>Avoid dynamic execution: avoid <code>eval()</code>/dynamic execution APIs whenever possible.</li>
<li>Validate and sanitize inputs: strict format validation; reject dangerous characters/expressions.</li>
<li>Parameterize: avoid string concatenation for commands/scripts.</li>
<li>Least privilege: minimize execution environment permissions.</li>
<li>Use secure frameworks: rely on frameworks providing safer patterns/mitigations.</li>
</ol></section><section><h2 id="open-redirect">Open Redirect<a class="anchor" href="#open-redirect"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
Open redirect lets attackers craft URLs that redirect users to malicious sites, enabling phishing and other social engineering. It happens when redirect targets are built from unvalidated user input.</p><p><strong>Recommendations:</strong></p><ol>
<li>Strict validation + allowlist: only allow redirects to trusted domains or internal URLs.</li>
<li>Avoid user-controlled redirect targets: sanitize and validate if unavoidable.</li>
<li>Use framework-safe redirect helpers: e.g., Spring MVC <code>RedirectAttributes</code>.</li>
<li>Log/monitor redirects: capture source and destination to detect abuse.</li>
<li>Security training: ensure the team can recognize and avoid open redirects.</li>
</ol></section></section>
<section><h1 id="cryptography">Cryptography<a class="anchor" href="#cryptography"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h1><section><h2 id="insecure-cipher-mode">Insecure Cipher Mode<a class="anchor" href="#insecure-cipher-mode"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
Block cipher modes describe how to apply a cipher repeatedly over data blocks (ECB/CBC/CFB/CTR/etc).</p><ul>
<li>ECB is weak because identical plaintext blocks produce identical ciphertext blocks.</li>
<li>CBC can be vulnerable to padding oracle attacks.</li>
<li>CTR avoids these specific issues and is generally better.</li>
</ul><p>Example (AES in ECB mode):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:65ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">SecretKeySpec key </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">SecretKeySpec</span><span style="--0:#E1E4E8;--1:#E1E4E8">(keyBytes, </span><span style="--0:#9ECBFF;--1:#9ECBFF">"AES"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">Cipher cipher </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> Cipher.</span><span style="--0:#B392F0;--1:#B392F0">getInstance</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"AES/ECB/PKCS7Padding"</span><span style="--0:#E1E4E8;--1:#E1E4E8">, </span><span style="--0:#9ECBFF;--1:#9ECBFF">"BC"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">cipher.</span><span style="--0:#B392F0;--1:#B392F0">init</span><span style="--0:#E1E4E8;--1:#E1E4E8">(Cipher.ENCRYPT_MODE, key);</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div><p><strong>Recommendations:</strong><br>
Avoid ECB and (where possible) CBC when encrypting multi-block data. Prefer CCM or (for performance) GCM when available.</p><p>Example (GCM mode):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:65ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">SecretKeySpec key </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">SecretKeySpec</span><span style="--0:#E1E4E8;--1:#E1E4E8">(keyBytes, </span><span style="--0:#9ECBFF;--1:#9ECBFF">"AES"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">Cipher cipher </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> Cipher.</span><span style="--0:#B392F0;--1:#B392F0">getInstance</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"AES/GCM/PKCS5Padding"</span><span style="--0:#E1E4E8;--1:#E1E4E8">, </span><span style="--0:#9ECBFF;--1:#9ECBFF">"BC"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">cipher.</span><span style="--0:#B392F0;--1:#B392F0">init</span><span style="--0:#E1E4E8;--1:#E1E4E8">(Cipher.ENCRYPT_MODE, key);</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div></section><section><h2 id="insecure-cipher-algorithm">Insecure Cipher Algorithm<a class="anchor" href="#insecure-cipher-algorithm"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
Using outdated/weak algorithms (e.g., DES, MD5) can lead to easy cracking and data exposure. As computing power increases, algorithms once considered secure may become weak.</p><p>Example (DES):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:70ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> javax.crypto.Cipher;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> javax.crypto.KeyGenerator;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> javax.crypto.SecretKey;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">UnsafeEncryptionExample</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">static</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">main</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#F97583;--1:#F97583">String</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#FFAB70;--1:#FFAB70">args</span><span style="--0:#E1E4E8;--1:#E1E4E8">) </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> Exception {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">KeyGenerator keyGenerator </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> KeyGenerator.</span><span style="--0:#B392F0;--1:#B392F0">getInstance</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"DES"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">SecretKey secretKey </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> keyGenerator.</span><span style="--0:#B392F0;--1:#B392F0">generateKey</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">Cipher cipher </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> Cipher.</span><span style="--0:#B392F0;--1:#B392F0">getInstance</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"DES/ECB/PKCS5Padding"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">cipher.</span><span style="--0:#B392F0;--1:#B392F0">init</span><span style="--0:#E1E4E8;--1:#E1E4E8">(Cipher.ENCRYPT_MODE, secretKey);</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">String plainText </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#9ECBFF;--1:#9ECBFF">"Sensitive Information"</span><span style="--0:#E1E4E8;--1:#E1E4E8">;</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">byte</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] encryptedText </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> cipher.</span><span style="--0:#B392F0;--1:#B392F0">doFinal</span><span style="--0:#E1E4E8;--1:#E1E4E8">(plainText.</span><span style="--0:#B392F0;--1:#B392F0">getBytes</span><span style="--0:#E1E4E8;--1:#E1E4E8">());</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">System.out.</span><span style="--0:#B392F0;--1:#B392F0">println</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"Encrypted: "</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">+</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">String</span><span style="--0:#E1E4E8;--1:#E1E4E8">(encryptedText));</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">17</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div><p><strong>Recommendations:</strong></p><ol>
<li>Use strong algorithms: e.g. AES with sufficient key length (AES-256).</li>
<li>Choose secure modes: e.g. CBC/GCM; prefer modes that provide integrity/authentication where applicable.</li>
<li>Use mature crypto libraries: avoid implementing crypto yourself.</li>
<li>Regularly review/update crypto: keep up with vulnerabilities and best practices.</li>
</ol><p>Example (AES-GCM with 256-bit key):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:122ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> javax.crypto.Cipher;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> javax.crypto.KeyGenerator;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> javax.crypto.SecretKey;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> javax.crypto.spec.GCMParameterSpec;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.security.SecureRandom;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">SecureGcmEncryptionExample</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">static</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">main</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#F97583;--1:#F97583">String</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#FFAB70;--1:#FFAB70">args</span><span style="--0:#E1E4E8;--1:#E1E4E8">) </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> Exception {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">KeyGenerator keyGenerator </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> KeyGenerator.</span><span style="--0:#B392F0;--1:#B392F0">getInstance</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"AES"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">keyGenerator.</span><span style="--0:#B392F0;--1:#B392F0">init</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#79B8FF;--1:#79B8FF">256</span><span style="--0:#E1E4E8;--1:#E1E4E8">); </span><span style="--0:#99A0A6;--1:#99A0A6">// 256-bit key</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">SecretKey secretKey </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> keyGenerator.</span><span style="--0:#B392F0;--1:#B392F0">generateKey</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">final</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">int</span><span style="--0:#E1E4E8;--1:#E1E4E8"> GCM_IV_LENGTH </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">12</span><span style="--0:#E1E4E8;--1:#E1E4E8">; </span><span style="--0:#99A0A6;--1:#99A0A6">// recommended IV length</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">final</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">int</span><span style="--0:#E1E4E8;--1:#E1E4E8"> GCM_TAG_LENGTH </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">128</span><span style="--0:#E1E4E8;--1:#E1E4E8">; </span><span style="--0:#99A0A6;--1:#99A0A6">// recommended tag length (bits)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">byte</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] iv </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">byte</span><span style="--0:#E1E4E8;--1:#E1E4E8">[GCM_IV_LENGTH];</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">17</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">SecureRandom</span><span style="--0:#E1E4E8;--1:#E1E4E8">().</span><span style="--0:#B392F0;--1:#B392F0">nextBytes</span><span style="--0:#E1E4E8;--1:#E1E4E8">(iv);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">18</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">GCMParameterSpec gcmParameterSpec </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">GCMParameterSpec</span><span style="--0:#E1E4E8;--1:#E1E4E8">(GCM_TAG_LENGTH, iv);</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">19</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">20</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">Cipher cipher </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> Cipher.</span><span style="--0:#B392F0;--1:#B392F0">getInstance</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"AES/GCM/NoPadding"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">21</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">cipher.</span><span style="--0:#B392F0;--1:#B392F0">init</span><span style="--0:#E1E4E8;--1:#E1E4E8">(Cipher.ENCRYPT_MODE, secretKey, gcmParameterSpec);</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">22</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">23</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">String plainText </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#9ECBFF;--1:#9ECBFF">"Sensitive Information"</span><span style="--0:#E1E4E8;--1:#E1E4E8">;</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">24</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">byte</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] encryptedText </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> cipher.</span><span style="--0:#B392F0;--1:#B392F0">doFinal</span><span style="--0:#E1E4E8;--1:#E1E4E8">(plainText.</span><span style="--0:#B392F0;--1:#B392F0">getBytes</span><span style="--0:#E1E4E8;--1:#E1E4E8">());</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">25</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">System.out.</span><span style="--0:#B392F0;--1:#B392F0">println</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"Encrypted securely with GCM: "</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">+</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.util.Base64.</span><span style="--0:#B392F0;--1:#B392F0">getEncoder</span><span style="--0:#E1E4E8;--1:#E1E4E8">().</span><span style="--0:#B392F0;--1:#B392F0">encodeToString</span><span style="--0:#E1E4E8;--1:#E1E4E8">(encryptedText));</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">26</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">27</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div></section><section><h2 id="insufficient-key-size-rsa">Insufficient Key Size (RSA)<a class="anchor" href="#insufficient-key-size-rsa"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
RSA security strongly depends on key size. 1024-bit RSA keys were once considered safe but are now much easier to break as computing power improved. Use 2048-bit or larger keys for stronger security.</p><p>Example (1024-bit RSA key pair):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:135ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.security.KeyPair;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.security.KeyPairGenerator;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.security.NoSuchAlgorithmException;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">WeakRsaKeyExample</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">static</span><span style="--0:#E1E4E8;--1:#E1E4E8"> KeyPair </span><span style="--0:#B392F0;--1:#B392F0">generateWeakRSAKeyPair</span><span style="--0:#E1E4E8;--1:#E1E4E8">() </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> NoSuchAlgorithmException {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">KeyPairGenerator keyPairGen </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> KeyPairGenerator.</span><span style="--0:#B392F0;--1:#B392F0">getInstance</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"RSA"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">keyPairGen.</span><span style="--0:#B392F0;--1:#B392F0">initialize</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#79B8FF;--1:#79B8FF">1024</span><span style="--0:#E1E4E8;--1:#E1E4E8">); </span><span style="--0:#99A0A6;--1:#99A0A6">// too short</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">return</span><span style="--0:#E1E4E8;--1:#E1E4E8"> keyPairGen.</span><span style="--0:#B392F0;--1:#B392F0">generateKeyPair</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">static</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">main</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#F97583;--1:#F97583">String</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#FFAB70;--1:#FFAB70">args</span><span style="--0:#E1E4E8;--1:#E1E4E8">) </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> Exception {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">KeyPair weakKeyPair </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">generateWeakRSAKeyPair</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">System.out.</span><span style="--0:#B392F0;--1:#B392F0">println</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"Generated weak RSA key pair with key size: "</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">+</span><span style="--0:#E1E4E8;--1:#E1E4E8"> weakKeyPair.</span><span style="--0:#B392F0;--1:#B392F0">getPrivate</span><span style="--0:#E1E4E8;--1:#E1E4E8">().</span><span style="--0:#B392F0;--1:#B392F0">getEncoded</span><span style="--0:#E1E4E8;--1:#E1E4E8">().length </span><span style="--0:#F97583;--1:#F97583">*</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">8</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">+</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#9ECBFF;--1:#9ECBFF">" bits"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div><p><strong>Recommendations:</strong></p><ol>
<li>Use at least 2048-bit RSA keys; for long-term security consider 3072/4096.</li>
<li>Rotate keys regularly.</li>
<li>Use strong randomness and vetted libraries for key generation.</li>
</ol><p>Example (2048-bit RSA key pair):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:139ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.security.KeyPair;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.security.KeyPairGenerator;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">import</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.security.NoSuchAlgorithmException;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">StrongRsaKeyExample</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">static</span><span style="--0:#E1E4E8;--1:#E1E4E8"> KeyPair </span><span style="--0:#B392F0;--1:#B392F0">generateStrongRSAKeyPair</span><span style="--0:#E1E4E8;--1:#E1E4E8">() </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> NoSuchAlgorithmException {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">KeyPairGenerator keyPairGen </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> KeyPairGenerator.</span><span style="--0:#B392F0;--1:#B392F0">getInstance</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"RSA"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">keyPairGen.</span><span style="--0:#B392F0;--1:#B392F0">initialize</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#79B8FF;--1:#79B8FF">2048</span><span style="--0:#E1E4E8;--1:#E1E4E8">); </span><span style="--0:#99A0A6;--1:#99A0A6">// recommended</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">return</span><span style="--0:#E1E4E8;--1:#E1E4E8"> keyPairGen.</span><span style="--0:#B392F0;--1:#B392F0">generateKeyPair</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">static</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">main</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#F97583;--1:#F97583">String</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#FFAB70;--1:#FFAB70">args</span><span style="--0:#E1E4E8;--1:#E1E4E8">) </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> Exception {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">KeyPair strongKeyPair </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">generateStrongRSAKeyPair</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">System.out.</span><span style="--0:#B392F0;--1:#B392F0">println</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"Generated strong RSA key pair with key size: "</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">+</span><span style="--0:#E1E4E8;--1:#E1E4E8"> strongKeyPair.</span><span style="--0:#B392F0;--1:#B392F0">getPrivate</span><span style="--0:#E1E4E8;--1:#E1E4E8">().</span><span style="--0:#B392F0;--1:#B392F0">getEncoded</span><span style="--0:#E1E4E8;--1:#E1E4E8">().length </span><span style="--0:#F97583;--1:#F97583">*</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">8</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">+</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#9ECBFF;--1:#9ECBFF">" bits"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div></section><section><h2 id="hardcoded-passwords">Hardcoded Passwords<a class="anchor" href="#hardcoded-passwords"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
Hardcoded plaintext passwords in source code/config/internal structures are highly insecure. Anyone who can access the code/files (devs, attackers via leaks, etc.) can obtain them. They are also hard to rotate, so a leak can cause long-term impact. This violates best practices.</p><p><strong>Recommendations:</strong><br>
Never hardcode passwords. Store secrets outside of code (e.g., environment variables, secret stores) and avoid plaintext storage anywhere in the system.</p></section><section><h2 id="hardcoded-encryption-keys">Hardcoded Encryption Keys<a class="anchor" href="#hardcoded-encryption-keys"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
Hardcoding encryption keys in code/config makes them easy to leak. Rotating keys requires code changes and redeployments, increasing risk and maintenance cost.</p><p><strong>Recommendations:</strong></p><ol>
<li>Store keys in environment variables or external secret stores (KMS/secret manager).</li>
<li>Implement key rotation and safe decommissioning.</li>
<li>Encrypt configuration files if keys must be stored there, and manage the encryption key securely.</li>
<li>Enforce access control and auditing for systems storing keys.</li>
<li>Use key derivation functions (PBKDF2/Argon2) where appropriate instead of hardcoded keys.</li>
</ol></section><section><h2 id="hardcoded-api-credentials">Hardcoded API Credentials<a class="anchor" href="#hardcoded-api-credentials"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
Hardcoding API keys/passwords/tokens in source code is unsafe and makes rotation hard. Leaks can lead to unauthorized access, data exposure, financial loss, etc.</p><p><strong>Recommendations:</strong></p><ol>
<li>Use environment variables.</li>
<li>Use config files that are excluded from version control; encrypt in production.</li>
<li>Use secret management services (AWS Secrets Manager, Azure Key Vault, etc.) with access control/auditing.</li>
<li>Apply least privilege to the credentials.</li>
<li>Rotate credentials regularly.</li>
</ol></section><section><h2 id="plaintext-passwords-in-configuration-files">Plaintext Passwords in Configuration Files<a class="anchor" href="#plaintext-passwords-in-configuration-files"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
Storing plaintext passwords in config files is a common security issue. Anyone with access can read them, and leaked configs can cause serious incidents. Config files also tend to be synced across environments, increasing exposure.</p><p><strong>Recommendations:</strong></p><ol>
<li>Use environment variables.</li>
<li>Use secret management systems (AWS Secrets Manager, HashiCorp Vault, etc.).</li>
<li>Encrypt secrets stored in config files so only the app can decrypt at runtime.</li>
<li>Use config management tools (Spring Cloud Config, Consul) that support external loading and encryption.</li>
</ol></section><section><h2 id="plaintext-passwords-in-test-files">Plaintext Passwords in Test Files<a class="anchor" href="#plaintext-passwords-in-test-files"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
Hardcoding plaintext passwords in test code/data is unsafe. Test assets might accidentally ship to production, or source repositories might be accessed by unauthorized parties. Test environments are also often weaker than production.</p><p><strong>Recommendations:</strong></p><ol>
<li>Use environment variables for test credentials.</li>
<li>Encrypt config files if secrets must exist there, and manage keys securely.</li>
<li>Use secret managers for test environment credentials.</li>
<li>Avoid real user accounts/passwords; use mocking where possible.</li>
</ol></section></section>
<section><h1 id="protocols">Protocols<a class="anchor" href="#protocols"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h1><section><h2 id="insecure-transport-protocol">Insecure Transport Protocol<a class="anchor" href="#insecure-transport-protocol"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
SSL and early TLS versions (SSLv2/SSLv3/TLS 1.0/TLS 1.1) have known vulnerabilities (BEAST/POODLE/CRIME, etc.) and are not considered safe. Modern secure communication should use TLS 1.2 or TLS 1.3.</p><p>Example (unsafe SSLv3):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:80ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">InsecureSSLExample</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">static</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">main</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#F97583;--1:#F97583">String</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#FFAB70;--1:#FFAB70">args</span><span style="--0:#E1E4E8;--1:#E1E4E8">) </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> Exception {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">SSLContext context </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> SSLContext.</span><span style="--0:#B392F0;--1:#B392F0">getInstance</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"SSLv3"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">context.</span><span style="--0:#B392F0;--1:#B392F0">init</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">, </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">, </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">SSLSocketFactory factory </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> context.</span><span style="--0:#B392F0;--1:#B392F0">getSocketFactory</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">SSLSocket socket </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (SSLSocket) factory.</span><span style="--0:#B392F0;--1:#B392F0">createSocket</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"example.com"</span><span style="--0:#E1E4E8;--1:#E1E4E8">, </span><span style="--0:#79B8FF;--1:#79B8FF">443</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent">        </span><span style="--0:#99A0A6;--1:#99A0A6">// insecure connection example</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div><p><strong>Recommendations:</strong></p><ol>
<li>Upgrade to TLS 1.2 or TLS 1.3.</li>
<li>Disable SSLv2/SSLv3/TLS 1.0/TLS 1.1 on servers and clients.</li>
<li>Patch OS/app/libs regularly to include the latest SSL/TLS fixes.</li>
<li>Review and update crypto policies and configs regularly.</li>
<li>Use secure cipher suites (avoid weak/broken ones).</li>
</ol><p>Example (TLS 1.2):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:80ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">SecureSSLExample</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">static</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">main</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#F97583;--1:#F97583">String</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#FFAB70;--1:#FFAB70">args</span><span style="--0:#E1E4E8;--1:#E1E4E8">) </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> Exception {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">SSLContext context </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> SSLContext.</span><span style="--0:#B392F0;--1:#B392F0">getInstance</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"TLSv1.2"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);  </span><span style="--0:#99A0A6;--1:#99A0A6">// TLSv1.2</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">context.</span><span style="--0:#B392F0;--1:#B392F0">init</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">, </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">, </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">SSLSocketFactory factory </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> context.</span><span style="--0:#B392F0;--1:#B392F0">getSocketFactory</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">SSLSocket socket </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (SSLSocket) factory.</span><span style="--0:#B392F0;--1:#B392F0">createSocket</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"example.com"</span><span style="--0:#E1E4E8;--1:#E1E4E8">, </span><span style="--0:#79B8FF;--1:#79B8FF">443</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent">        </span><span style="--0:#99A0A6;--1:#99A0A6">// secure connection example</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div></section><section><h2 id="missing-content-security-policy-csp">Missing Content Security Policy (CSP)<a class="anchor" href="#missing-content-security-policy-csp"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
CSP helps prevent XSS and other injection attacks by allowlisting which resources can be loaded/executed. Without CSP (or with a weak CSP), pages are easier to exploit via injected scripts.</p><p><strong>Recommendations:</strong></p><ol>
<li>Enable and properly configure CSP via the <code>Content-Security-Policy</code> header; strictly restrict script/style/img/font/form/resource sources to trusted origins.</li>
<li>Avoid <code>unsafe-inline</code> and <code>unsafe-eval</code> where possible.</li>
<li>Review and update CSP regularly as the app evolves.</li>
<li>Use reporting (<code>report-uri</code> / <code>report-to</code>) to collect violation reports.</li>
<li>Test thoroughly before rollout to avoid breaking legitimate resources.</li>
</ol></section><section><h2 id="server-identity-verification-disabled">Server Identity Verification Disabled<a class="anchor" href="#server-identity-verification-disabled"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
In SSL/TLS connections, verifying server identity is essential. Clients typically validate the certificate chain (trusted CA) and hostname match. If verification is disabled, the client can be vulnerable to MITM attacks.</p><p>Example (disables hostname verification):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:109ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">InsecureConnection</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">static</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">main</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#F97583;--1:#F97583">String</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#FFAB70;--1:#FFAB70">args</span><span style="--0:#E1E4E8;--1:#E1E4E8">) </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> Exception {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">HttpsURLConnection connection </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> (HttpsURLConnection) </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">URL</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"https://example.com"</span><span style="--0:#E1E4E8;--1:#E1E4E8">).</span><span style="--0:#B392F0;--1:#B392F0">openConnection</span><span style="--0:#E1E4E8;--1:#E1E4E8">();</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">connection.</span><span style="--0:#B392F0;--1:#B392F0">setHostnameVerifier</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">HostnameVerifier</span><span style="--0:#E1E4E8;--1:#E1E4E8">() {</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">@</span><span style="--0:#F97583;--1:#F97583">Override</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">boolean</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">verify</span><span style="--0:#E1E4E8;--1:#E1E4E8">(String </span><span style="--0:#FFAB70;--1:#FFAB70">hostname</span><span style="--0:#E1E4E8;--1:#E1E4E8">, SSLSession </span><span style="--0:#FFAB70;--1:#FFAB70">session</span><span style="--0:#E1E4E8;--1:#E1E4E8">) {</span></div></div><div class="ec-line" style="--ecIndent:16ch"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent">                </span><span style="--0:#F97583;--1:#F97583">return</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">true</span><span style="--0:#E1E4E8;--1:#E1E4E8">;  </span><span style="--0:#99A0A6;--1:#99A0A6">// insecure: no verification</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">});</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span class="indent">        </span><span style="--0:#B392F0;--1:#B392F0">trustAllHttpsCertificates</span><span style="--0:#E1E4E8;--1:#E1E4E8">(connection); </span><span style="--0:#99A0A6;--1:#99A0A6">// assume this makes it trust all certs</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code">
</div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">private</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">static</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">trustAllHttpsCertificates</span><span style="--0:#E1E4E8;--1:#E1E4E8">(HttpsURLConnection </span><span style="--0:#FFAB70;--1:#FFAB70">conn</span><span style="--0:#E1E4E8;--1:#E1E4E8">) {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span class="indent">        </span><span style="--0:#99A0A6;--1:#99A0A6">// implementation omitted: trusts all certificates (unsafe)</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div><p><strong>Recommendations:</strong></p><ol>
<li>Always enable server identity verification.</li>
<li>Use correctly configured certificates issued by trusted CAs, with correct DNS names.</li>
<li>Check certificate revocation status (OCSP/CRL) where appropriate.</li>
<li>Enforce full certificate chain validation.</li>
<li>Follow best practices and use secure libraries to avoid disabling validation accidentally.</li>
</ol></section><section><h2 id="overly-broad-certificate-trust">Overly Broad Certificate Trust<a class="anchor" href="#overly-broad-certificate-trust"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h2><p><strong>Description:</strong><br>
Trusting too many certificates (including self-signed/untrusted ones) weakens security and enables MITM. Common anti-pattern: trusting all certificates.</p><p>Example (trust all certificates):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:111ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">InsecureTrustManager</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">static</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">main</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#F97583;--1:#F97583">String</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#FFAB70;--1:#FFAB70">args</span><span style="--0:#E1E4E8;--1:#E1E4E8">) </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> Exception {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">SSLContext sc </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> SSLContext.</span><span style="--0:#B392F0;--1:#B392F0">getInstance</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"TLS"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#F97583">TrustManager</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] trustAllCerts </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">TrustManager</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] {</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span class="indent">            </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">X509TrustManager</span><span style="--0:#E1E4E8;--1:#E1E4E8">() {</span></div></div><div class="ec-line" style="--ecIndent:16ch"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent">                </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.security.cert.</span><span style="--0:#F97583;--1:#F97583">X509Certificate</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#B392F0;--1:#B392F0">getAcceptedIssuers</span><span style="--0:#E1E4E8;--1:#E1E4E8">() {</span></div></div><div class="ec-line" style="--ecIndent:20ch"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent">                    </span><span style="--0:#F97583;--1:#F97583">return</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">;</span></div></div><div class="ec-line" style="--ecIndent:16ch"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">                </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line" style="--ecIndent:16ch"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span class="indent">                </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">checkClientTrusted</span><span style="--0:#E1E4E8;--1:#E1E4E8">(java.security.cert.</span><span style="--0:#F97583;--1:#F97583">X509Certificate</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#FFAB70;--1:#FFAB70">certs</span><span style="--0:#E1E4E8;--1:#E1E4E8">, String </span><span style="--0:#FFAB70;--1:#FFAB70">authType</span><span style="--0:#E1E4E8;--1:#E1E4E8">) { }</span></div></div><div class="ec-line" style="--ecIndent:16ch"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span class="indent">                </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">checkServerTrusted</span><span style="--0:#E1E4E8;--1:#E1E4E8">(java.security.cert.</span><span style="--0:#F97583;--1:#F97583">X509Certificate</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#FFAB70;--1:#FFAB70">certs</span><span style="--0:#E1E4E8;--1:#E1E4E8">, String </span><span style="--0:#FFAB70;--1:#FFAB70">authType</span><span style="--0:#E1E4E8;--1:#E1E4E8">) { }</span></div></div><div class="ec-line" style="--ecIndent:12ch"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">            </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">};</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">sc.</span><span style="--0:#B392F0;--1:#B392F0">init</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">, trustAllCerts, </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.security.</span><span style="--0:#B392F0;--1:#B392F0">SecureRandom</span><span style="--0:#E1E4E8;--1:#E1E4E8">());</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">HttpsURLConnection.</span><span style="--0:#B392F0;--1:#B392F0">setDefaultSSLSocketFactory</span><span style="--0:#E1E4E8;--1:#E1E4E8">(sc.</span><span style="--0:#B392F0;--1:#B392F0">getSocketFactory</span><span style="--0:#E1E4E8;--1:#E1E4E8">());</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span class="indent">        </span><span style="--0:#99A0A6;--1:#99A0A6">// insecure: trusts all certificates</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">17</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div><p><strong>Recommendations:</strong></p><ol>
<li>Trust only known, reliable CAs (maintain an explicit trust store).</li>
<li>Validate the full certificate chain (root + intermediates).</li>
<li>Use certificate pinning when appropriate.</li>
<li>Do not trust self-signed certs except in controlled environments (e.g., internal testing).</li>
<li>Keep trust stores updated (add new CAs; remove revoked/unsafe ones).</li>
</ol><p>Example (use system default trust manager):</p><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="java" class="wrap" style="--ecMaxLine:98ch"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">class</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">SecureTrustManager</span><span style="--0:#E1E4E8;--1:#E1E4E8"> {</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#F97583">public</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">static</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#F97583;--1:#F97583">void</span><span style="--0:#E1E4E8;--1:#E1E4E8"> </span><span style="--0:#B392F0;--1:#B392F0">main</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#F97583;--1:#F97583">String</span><span style="--0:#E1E4E8;--1:#E1E4E8">[] </span><span style="--0:#FFAB70;--1:#FFAB70">args</span><span style="--0:#E1E4E8;--1:#E1E4E8">) </span><span style="--0:#F97583;--1:#F97583">throws</span><span style="--0:#E1E4E8;--1:#E1E4E8"> Exception {</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">SSLContext sc </span><span style="--0:#F97583;--1:#F97583">=</span><span style="--0:#E1E4E8;--1:#E1E4E8"> SSLContext.</span><span style="--0:#B392F0;--1:#B392F0">getInstance</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#9ECBFF;--1:#9ECBFF">"TLS"</span><span style="--0:#E1E4E8;--1:#E1E4E8">);</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">sc.</span><span style="--0:#B392F0;--1:#B392F0">init</span><span style="--0:#E1E4E8;--1:#E1E4E8">(</span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">, </span><span style="--0:#79B8FF;--1:#79B8FF">null</span><span style="--0:#E1E4E8;--1:#E1E4E8">, </span><span style="--0:#F97583;--1:#F97583">new</span><span style="--0:#E1E4E8;--1:#E1E4E8"> java.security.</span><span style="--0:#B392F0;--1:#B392F0">SecureRandom</span><span style="--0:#E1E4E8;--1:#E1E4E8">()); </span><span style="--0:#99A0A6;--1:#99A0A6">// use system default trust manager</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">        </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">HttpsURLConnection.</span><span style="--0:#B392F0;--1:#B392F0">setDefaultSSLSocketFactory</span><span style="--0:#E1E4E8;--1:#E1E4E8">(sc.</span><span style="--0:#B392F0;--1:#B392F0">getSocketFactory</span><span style="--0:#E1E4E8;--1:#E1E4E8">());</span></div></div><div class="ec-line" style="--ecIndent:8ch"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span class="indent">        </span><span style="--0:#99A0A6;--1:#99A0A6">// default trust manager trusts only certificates issued by trusted CAs</span></div></div><div class="ec-line" style="--ecIndent:4ch"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#E1E4E8">    </span></span><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code"><span style="--0:#E1E4E8;--1:#E1E4E8">}</span></div></div></code><button class="copy-btn" aria-label="Copy code"><div class="copy-btn-icon"><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon copy-icon"><path d="M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z"></path></svg><svg viewBox="0 -960 960 960" xmlns="http://www.w3.org/2000/svg" class="copy-btn-icon success-icon"><path d="m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z"></path></svg></div></button></pre></figure></div></section></section>
<section><h1 id="other">Other<a class="anchor" href="#other"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h1><section><h3 id="weak-randomness">Weak Randomness<a class="anchor" href="#weak-randomness"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3><p><strong>Description:</strong><br>
Using weak RNGs in security contexts (session ids, passwords, keys) can produce predictable values, enabling replay/session hijacking and other attacks. This often happens when using non-cryptographic PRNGs like <code>Random</code>.</p><p><strong>Recommendations:</strong></p><ol>
<li>Use a CSPRNG: e.g. Java <code>SecureRandom</code>, not <code>Random</code>.</li>
<li>Reseed when appropriate (especially after security events).</li>
<li>Avoid custom RNG algorithms; use vetted implementations.</li>
<li>Combine multiple entropy sources for high-security needs.</li>
<li>Assess randomness strategy periodically.</li>
</ol></section><section><h3 id="insecure-spring-default-configuration">Insecure Spring Default Configuration<a class="anchor" href="#insecure-spring-default-configuration"><span class="anchor-icon" data-pagefind-ignore="">#</span></a></h3><p><strong>Description:</strong><br>
In Spring Boot, <code>management.security.enabled</code> controls security for management endpoints. Misconfiguration (e.g. <code>false</code>) can expose sensitive endpoints (<code>metrics</code>, <code>health</code>, <code>info</code>, etc.) to unauthorized users.</p><p><strong>Recommendations:</strong></p><ol>
<li>Enable management endpoint security by default (<code>management.security.enabled=true</code>).</li>
<li>Use roles/permissions to restrict access (Spring Security).</li>
<li>Restrict network access (firewalls/security groups; internal-only).</li>
<li>Use layered defenses (authn/authz/logging/monitoring).</li>
<li>Review and update configuration regularly.</li>
</ol></section></section>  </div> <script type="module">document.addEventListener("click",function(s){const t=s.target;if(t&&t.classList.contains("copy-btn")){const c=t.closest("pre")?.querySelector("code"),i=Array.from(c?.querySelectorAll(".code:not(summary *)")??[]).map(e=>e.textContent).map(e=>e===`
`?"":e).join(`
`);navigator.clipboard.writeText(i);const o=t.getAttribute("data-timeout-id");o&&clearTimeout(parseInt(o)),t.classList.add("success");const n=setTimeout(()=>{t.classList.remove("success")},1e3);t.setAttribute("data-timeout-id",n.toString())}});</script> <div class="relative transition overflow-hidden bg-[var(--license-block-bg)] py-5 px-6 mb-6 rounded-xl license-container onload-animation"> <div class="transition font-bold text-black/75 dark:text-white/75"> Remediation Recommendations (Summary) </div> <a href="https://springkill.github.io/en/posts/修复建议汇总/" class="link text-[var(--primary)]"> https://springkill.github.io/en/posts/修复建议汇总/ </a> <div class="flex gap-6 mt-2"> <div> <div class="transition text-black/30 dark:text-white/30 text-sm">Author</div> <div class="transition text-black/75 dark:text-white/75 line-clamp-2">SpringKill</div> </div> <div> <div class="transition text-black/30 dark:text-white/30 text-sm">Published at</div> <div class="transition text-black/75 dark:text-white/75 line-clamp-2">2024-09-12</div> </div> <div> <div class="transition text-black/30 dark:text-white/30 text-sm">License</div> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" class="link text-[var(--primary)] line-clamp-2">CC BY-NC-SA 4.0</a> </div> </div> <svg width="0.97em" height="1em" class="transition text-[15rem] absolute pointer-events-none right-6 top-1/2 -translate-y-1/2 text-black/5 dark:text-white/5" data-icon="fa6-brands:creative-commons">   <symbol id="ai:fa6-brands:creative-commons" viewBox="0 0 496 512"><path fill="currentColor" d="m245.83 214.87l-33.22 17.28c-9.43-19.58-25.24-19.93-27.46-19.93c-22.13 0-33.22 14.61-33.22 43.84c0 23.57 9.21 43.84 33.22 43.84c14.47 0 24.65-7.09 30.57-21.26l30.55 15.5c-6.17 11.51-25.69 38.98-65.1 38.98c-22.6 0-73.96-10.32-73.96-77.05c0-58.69 43-77.06 72.63-77.06c30.72-.01 52.7 11.95 65.99 35.86m143.05 0l-32.78 17.28c-9.5-19.77-25.72-19.93-27.9-19.93c-22.14 0-33.22 14.61-33.22 43.84c0 23.55 9.23 43.84 33.22 43.84c14.45 0 24.65-7.09 30.54-21.26l31 15.5c-2.1 3.75-21.39 38.98-65.09 38.98c-22.69 0-73.96-9.87-73.96-77.05c0-58.67 42.97-77.06 72.63-77.06c30.71-.01 52.58 11.95 65.56 35.86M247.56 8.05C104.74 8.05 0 123.11 0 256.05c0 138.49 113.6 248 247.56 248c129.93 0 248.44-100.87 248.44-248c0-137.87-106.62-248-248.44-248m.87 450.81c-112.54 0-203.7-93.04-203.7-202.81c0-105.42 85.43-203.27 203.72-203.27c112.53 0 202.82 89.46 202.82 203.26c-.01 121.69-99.68 202.82-202.84 202.82"/></symbol><use href="#ai:fa6-brands:creative-commons"></use>  </svg> </div> </div> </div> <div class="flex flex-col md:flex-row justify-between mb-4 gap-4 overflow-hidden w-full"> <a href="/en/posts/自动部署/" class="w-full font-bold overflow-hidden active:scale-95"> <div class="btn-card rounded-2xl w-full h-[3.75rem] max-w-full px-4 flex items-center !justify-start gap-4"> <svg width="1em" height="1em" class="text-[2rem] text-[var(--primary)]" data-icon="material-symbols:chevron-left-rounded">   <symbol id="ai:material-symbols:chevron-left-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="m10.8 12l3.9 3.9q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-4.6-4.6q-.15-.15-.212-.325T8.425 12t.063-.375t.212-.325l4.6-4.6q.275-.275.7-.275t.7.275t.275.7t-.275.7z"/></symbol><use href="#ai:material-symbols:chevron-left-rounded"></use>  </svg> <div class="overflow-hidden transition overflow-ellipsis whitespace-nowrap max-w-[calc(100%_-_3rem)] text-black/75 dark:text-white/75"> Automated Deployment </div> </div> </a> <a href="/en/posts/某报表模板注入/" class="w-full font-bold overflow-hidden active:scale-95"> <div class="btn-card rounded-2xl w-full h-[3.75rem] max-w-full px-4 flex items-center !justify-end gap-4"> <div class="overflow-hidden transition overflow-ellipsis whitespace-nowrap max-w-[calc(100%_-_3rem)] text-black/75 dark:text-white/75"> Template Injection in a Report System </div> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-[2rem] text-[var(--primary)]" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> </div> </a> </div>  <div class="footer col-span-2 onload-animation hidden lg:block"> <!--<div class="border-t border-[var(&#45;&#45;primary)] mx-16 border-dashed py-8 max-w-[var(&#45;&#45;page-width)] flex flex-col items-center justify-center px-6">--><div class="transition border-t border-black/10 dark:border-white/15 my-10 border-dashed mx-32"></div> <!--<div class="transition bg-[oklch(92%_0.01_var(&#45;&#45;hue))] dark:bg-black rounded-2xl py-8 mt-4 mb-8 flex flex-col items-center justify-center px-6">--> <div class="transition border-dashed border-[oklch(85%_0.01_var(--hue))] dark:border-white/15 rounded-2xl mb-12 flex flex-col items-center justify-center px-6"> <div class="transition text-50 text-sm text-center">
&copy; <span id="copyright-year">2026</span> SpringKill. All Rights Reserved. /
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="/rss.xml">RSS</a> /
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="/sitemap-index.xml">Sitemap</a><br>
Powered by
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://astro.build">Astro</a> &
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://github.com/saicaca/fuwari">Fuwari</a> </div> </div> </div> </div> </main> <div class="footer col-span-2 onload-animation block lg:hidden"> <!--<div class="border-t border-[var(&#45;&#45;primary)] mx-16 border-dashed py-8 max-w-[var(&#45;&#45;page-width)] flex flex-col items-center justify-center px-6">--><div class="transition border-t border-black/10 dark:border-white/15 my-10 border-dashed mx-32"></div> <!--<div class="transition bg-[oklch(92%_0.01_var(&#45;&#45;hue))] dark:bg-black rounded-2xl py-8 mt-4 mb-8 flex flex-col items-center justify-center px-6">--> <div class="transition border-dashed border-[oklch(85%_0.01_var(--hue))] dark:border-white/15 rounded-2xl mb-12 flex flex-col items-center justify-center px-6"> <div class="transition text-50 text-sm text-center">
&copy; <span id="copyright-year">2026</span> SpringKill. All Rights Reserved. /
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="/rss.xml">RSS</a> /
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="/sitemap-index.xml">Sitemap</a><br>
Powered by
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://astro.build">Astro</a> &
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://github.com/saicaca/fuwari">Fuwari</a> </div> </div> </div> </div> <!-- There can't be a filter on parent element, or it will break `fixed` --><div class="back-to-top-wrapper hidden lg:block" data-astro-cid-eymb5ayk> <div id="back-to-top-btn" class="back-to-top-btn hide flex items-center rounded-2xl overflow-hidden transition" onclick="backToTop()" data-astro-cid-eymb5ayk> <button aria-label="Back to Top" class="btn-card h-[3.75rem] w-[3.75rem]" data-astro-cid-eymb5ayk> <svg width="1em" height="1em" class="mx-auto" data-astro-cid-eymb5ayk="true" data-icon="material-symbols:keyboard-arrow-up-rounded">   <symbol id="ai:material-symbols:keyboard-arrow-up-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="m12 10.8l-3.9 3.9q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7l4.6-4.6q.3-.3.7-.3t.7.3l4.6 4.6q.275.275.275.7t-.275.7t-.7.275t-.7-.275z"/></symbol><use href="#ai:material-symbols:keyboard-arrow-up-rounded"></use>  </svg> </button> </div> </div>  <script>
function backToTop() {
    window.scroll({ top: 0, behavior: 'smooth' });
}
</script> </div> </div>  <div class="absolute w-full z-0 hidden 2xl:block"> <div class="relative max-w-[var(--page-width)] mx-auto"> <!-- TOC component --> <div id="toc-wrapper" class="hidden lg:block transition absolute top-0 -right-[var(--toc-width)] w-[var(--toc-width)] items-center"> <div id="toc-inner-wrapper" class="fixed top-14 w-[var(--toc-width)] h-[calc(100vh_-_20rem)] overflow-y-scroll overflow-x-hidden hide-scrollbar"> <div id="toc" class="w-full h-full transition-swup-fade "> <div class="h-8 w-full"></div> <table-of-contents class="group"><a href="#web-vulnerabilities" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">1</div><div class="transition text-sm text-50">Web Vulnerabilities</div></a><a href="#reflected-xss" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Reflected XSS</div></a><a href="#stored-xss" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Stored XSS</div></a><a href="#dom-based-xss" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">DOM-based XSS</div></a><a href="#directory-traversal" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Directory Traversal</div></a><a href="#sql-injection" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">SQL Injection</div></a><a href="#sql-injection-mybatis" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">SQL Injection (MyBatis)</div></a><a href="#command-injection" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Command Injection</div></a><a href="#server-side-request-forgery-ssrf" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Server-Side Request Forgery (SSRF)</div></a><a href="#code-injection" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Code Injection</div></a><a href="#open-redirect" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Open Redirect</div></a><a href="#cryptography" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">2</div><div class="transition text-sm text-50">Cryptography</div></a><a href="#insecure-cipher-mode" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Insecure Cipher Mode</div></a><a href="#insecure-cipher-algorithm" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Insecure Cipher Algorithm</div></a><a href="#insufficient-key-size-rsa" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Insufficient Key Size (RSA)</div></a><a href="#hardcoded-passwords" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Hardcoded Passwords</div></a><a href="#hardcoded-encryption-keys" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Hardcoded Encryption Keys</div></a><a href="#hardcoded-api-credentials" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Hardcoded API Credentials</div></a><a href="#plaintext-passwords-in-configuration-files" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Plaintext Passwords in Configuration Files</div></a><a href="#plaintext-passwords-in-test-files" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Plaintext Passwords in Test Files</div></a><a href="#protocols" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">3</div><div class="transition text-sm text-50">Protocols</div></a><a href="#insecure-transport-protocol" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Insecure Transport Protocol</div></a><a href="#missing-content-security-policy-csp" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Missing Content Security Policy (CSP)</div></a><a href="#server-identity-verification-disabled" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Server Identity Verification Disabled</div></a><a href="#overly-broad-certificate-trust" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold ml-4"><div class="transition w-2 h-2 rounded-[0.1875rem] bg-[var(--toc-badge-bg)]"></div></div><div class="transition text-sm text-50">Overly Broad Certificate Trust</div></a><a href="#other" class="px-2 flex gap-2 relative transition w-full min-h-9 rounded-xl
        hover:bg-[var(--toc-btn-hover)] active:bg-[var(--toc-btn-active)] py-2
    "><div class="transition w-5 h-5 shrink-0 rounded-lg text-xs flex items-center justify-center font-bold bg-[var(--toc-badge-bg)] text-[var(--btn-content)]">4</div><div class="transition text-sm text-50">Other</div></a><div id="active-indicator" style="opacity: 0" class="-z-10 absolute bg-[var(--toc-btn-hover)] left-0 right-0 rounded-xl transition-all group-hover:bg-transparent border-2 border-[var(--toc-btn-hover)] group-hover:border-[var(--toc-btn-active)] border-dashed"></div></table-of-contents><script type="module">class l extends HTMLElement{tocEl=null;visibleClass="visible";observer;anchorNavTarget=null;headingIdxMap=new Map;headings=[];sections=[];tocEntries=[];active=[];activeIndicator=null;constructor(){super(),this.observer=new IntersectionObserver(this.markVisibleSection,{threshold:0})}markVisibleSection=t=>{t.forEach(e=>{const i=e.target.children[0]?.getAttribute("id"),s=i?this.headingIdxMap.get(i):void 0;s!=null&&(this.active[s]=e.isIntersecting),e.isIntersecting&&this.anchorNavTarget==e.target.firstChild&&(this.anchorNavTarget=null)}),this.active.includes(!0)||this.fallback(),this.update()};toggleActiveHeading=()=>{let t=this.active.length-1,e=this.active.length-1,i=-1;for(;t>=0&&!this.active[t];)this.tocEntries[t].classList.remove(this.visibleClass),t--;for(;t>=0&&this.active[t];)this.tocEntries[t].classList.add(this.visibleClass),e=Math.min(e,t),i=Math.max(i,t),t--;for(;t>=0;)this.tocEntries[t].classList.remove(this.visibleClass),t--;if(e>i)this.activeIndicator?.setAttribute("style","opacity: 0");else{let s=this.tocEl?.getBoundingClientRect().top||0,n=this.tocEl?.scrollTop||0,o=this.tocEntries[e].getBoundingClientRect().top-s+n,c=this.tocEntries[i].getBoundingClientRect().bottom-s+n;this.activeIndicator?.setAttribute("style",`top: ${o}px; height: ${c-o}px`)}};scrollToActiveHeading=()=>{if(this.anchorNavTarget||!this.tocEl)return;const t=document.querySelectorAll(`#toc .${this.visibleClass}`);if(!t.length)return;const e=t[0],i=t[t.length-1],s=this.tocEl.clientHeight;let n;i.getBoundingClientRect().bottom-e.getBoundingClientRect().top<.9*s?n=e.offsetTop-32:n=i.offsetTop-s*.8,this.tocEl.scrollTo({top:n,left:0,behavior:"smooth"})};update=()=>{requestAnimationFrame(()=>{this.toggleActiveHeading(),this.scrollToActiveHeading()})};fallback=()=>{if(this.sections.length)for(let t=0;t<this.sections.length;t++){let e=this.sections[t].getBoundingClientRect().top,i=this.sections[t].getBoundingClientRect().bottom;if(this.isInRange(e,0,window.innerHeight)||this.isInRange(i,0,window.innerHeight)||e<0&&i>window.innerHeight)this.markActiveHeading(t);else if(e>window.innerHeight)break}};markActiveHeading=t=>{this.active[t]=!0};handleAnchorClick=t=>{const e=t.composedPath().find(i=>i instanceof HTMLAnchorElement);if(e){const i=decodeURIComponent(e.hash?.substring(1)),s=this.headingIdxMap.get(i);s!==void 0?this.anchorNavTarget=this.headings[s]:this.anchorNavTarget=null}};isInRange(t,e,i){return e<t&&t<i}connectedCallback(){const t=document.querySelector(".prose");t?t.addEventListener("animationend",()=>{this.init()},{once:!0}):console.debug("Animation element not found")}init(){if(this.tocEl=document.getElementById("toc-inner-wrapper"),!!this.tocEl&&(this.tocEl.addEventListener("click",this.handleAnchorClick,{capture:!0}),this.activeIndicator=document.getElementById("active-indicator"),this.tocEntries=Array.from(document.querySelectorAll("#toc a[href^='#']")),this.tocEntries.length!==0)){this.sections=new Array(this.tocEntries.length),this.headings=new Array(this.tocEntries.length);for(let t=0;t<this.tocEntries.length;t++){const e=decodeURIComponent(this.tocEntries[t].hash?.substring(1)),i=document.getElementById(e),s=i?.parentElement;i instanceof HTMLElement&&s instanceof HTMLElement&&(this.headings[t]=i,this.sections[t]=s,this.headingIdxMap.set(e,t))}this.active=new Array(this.tocEntries.length).fill(!1),this.sections.forEach(t=>this.observer.observe(t)),this.fallback(),this.update()}}disconnectedCallback(){this.sections.forEach(t=>this.observer.unobserve(t)),this.observer.disconnect(),this.tocEl?.removeEventListener("click",this.handleAnchorClick)}}customElements.get("table-of-contents")||customElements.define("table-of-contents",l);</script> <div class="h-8 w-full"></div> </div> </div> </div> <!-- #toc needs to exist for Swup to work normally -->  </div> </div>  <!-- increase the page height during page transition to prevent the scrolling animation from jumping --> <div id="page-height-extend" class="hidden h-[300vh]" data-astro-cid-sckkx6r4 style="--bannerOffset: 15vh;--banner-height-home: 65vh;--banner-height: 35vh;--configHue: 35;--page-width: 75rem;"></div>  <script type="module" src="/_astro/Layout.astro_astro_type_script_index_0_lang.DAHrxWCB.js"></script> <script type="module" src="/_astro/Layout.astro_astro_type_script_index_1_lang.DbX_bGOa.js"></script></body></html>